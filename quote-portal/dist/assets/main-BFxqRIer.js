import{r as kt,a as ee,A as Y,R as e,b as Re,s as Ge,D as wt,F as St,U as Nt,c as Ct,u as Pt}from"./UsersTab-DdzZObo9.js";var Ve={exports:{}},ze={},tt;function Dt(){if(tt)return ze;tt=1;/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return(function(){function t(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===ce?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case V:return"Fragment";case j:return"Profiler";case O:return"StrictMode";case ie:return"Suspense";case se:return"SuspenseList";case ne:return"Activity"}if(typeof m=="object")switch(typeof m.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),m.$$typeof){case z:return"Portal";case Q:return m.displayName||"Context";case L:return(m._context.displayName||"Context")+".Consumer";case te:var T=m.render;return m=m.displayName,m||(m=T.displayName||T.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case be:return T=m.displayName||null,T!==null?T:t(m.type)||"Memo";case ae:T=m._payload,m=m._init;try{return t(m(T))}catch{}}return null}function c(m){return""+m}function n(m){try{c(m);var T=!1}catch{T=!0}if(T){T=console;var i=T.error,g=typeof Symbol=="function"&&Symbol.toStringTag&&m[Symbol.toStringTag]||m.constructor.name||"Object";return i.call(T,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",g),c(m)}}function b(m){if(m===V)return"<>";if(typeof m=="object"&&m!==null&&m.$$typeof===ae)return"<...>";try{var T=t(m);return T?"<"+T+">":"<...>"}catch{return"<...>"}}function o(){var m=q.A;return m===null?null:m.getOwner()}function u(){return Error("react-stack-top-frame")}function d(m){if(Z.call(m,"key")){var T=Object.getOwnPropertyDescriptor(m,"key").get;if(T&&T.isReactWarning)return!1}return m.key!==void 0}function k(m,T){function i(){X||(X=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",T))}i.isReactWarning=!0,Object.defineProperty(m,"key",{get:i,configurable:!0})}function x(){var m=t(this.type);return Se[m]||(Se[m]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),m=this.props.ref,m!==void 0?m:null}function P(m,T,i,g,S,p){var C=i.ref;return m={$$typeof:h,type:m,key:T,props:i,_owner:g},(C!==void 0?C:null)!==null?Object.defineProperty(m,"ref",{enumerable:!1,get:x}):Object.defineProperty(m,"ref",{enumerable:!1,value:null}),m._store={},Object.defineProperty(m._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(m,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(m,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:S}),Object.defineProperty(m,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:p}),Object.freeze&&(Object.freeze(m.props),Object.freeze(m)),m}function E(m,T,i,g,S,p){var C=T.children;if(C!==void 0)if(g)if(he(C)){for(g=0;g<C.length;g++)y(C[g]);Object.freeze&&Object.freeze(C)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else y(C);if(Z.call(T,"key")){C=t(m);var _=Object.keys(T).filter(function(oe){return oe!=="key"});g=0<_.length?"{key: someKey, "+_.join(": ..., ")+": ...}":"{key: someKey}",ve[C+g]||(_=0<_.length?"{"+_.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,g,C,_,C),ve[C+g]=!0)}if(C=null,i!==void 0&&(n(i),C=""+i),d(T)&&(n(T.key),C=""+T.key),"key"in T){i={};for(var I in T)I!=="key"&&(i[I]=T[I])}else i=T;return C&&k(i,typeof m=="function"?m.displayName||m.name||"Unknown":m),P(m,C,i,o(),S,p)}function y(m){D(m)?m._store&&(m._store.validated=1):typeof m=="object"&&m!==null&&m.$$typeof===ae&&(m._payload.status==="fulfilled"?D(m._payload.value)&&m._payload.value._store&&(m._payload.value._store.validated=1):m._store&&(m._store.validated=1))}function D(m){return typeof m=="object"&&m!==null&&m.$$typeof===h}var f=kt(),h=Symbol.for("react.transitional.element"),z=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),L=Symbol.for("react.consumer"),Q=Symbol.for("react.context"),te=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),be=Symbol.for("react.memo"),ae=Symbol.for("react.lazy"),ne=Symbol.for("react.activity"),ce=Symbol.for("react.client.reference"),q=f.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=Object.prototype.hasOwnProperty,he=Array.isArray,pe=console.createTask?console.createTask:function(){return null};f={react_stack_bottom_frame:function(m){return m()}};var X,Se={},Ee=f.react_stack_bottom_frame.bind(f,u)(),Ne=pe(b(u)),ve={};ze.Fragment=V,ze.jsxDEV=function(m,T,i,g){var S=1e4>q.recentlyCreatedOwnerStacks++;return E(m,T,i,g,S?Error("react-stack-top-frame"):Ee,S?pe(b(m)):Ne)}})(),ze}var at;function Ft(){return at||(at=1,Ve.exports=Dt()),Ve.exports}var J=Ft();function Ke(){const t=new Date,c=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),b=`bk_id_counter_${c}${n}`;let o=1;try{const d=localStorage.getItem(b);d&&(o=parseInt(d,10)+1)}catch{}try{localStorage.setItem(b,o.toString())}catch{}const u=String(o).padStart(5,"0");return`BK${c}${n}${u}`}function Be(t,c){try{const n=document.createElement("a");n.href=c,n.download=t||"download",document.body.appendChild(n),n.click(),n.remove()}catch{}}const je=["pdf","png","jpg","jpeg","dxf","dwg","step","stp","iges","igs"],At=2,_e=1.5,Tt=5;function Ie(t){const c=t.lastIndexOf(".");return c>=0?t.slice(c+1).toLowerCase():""}function Ye(t){return new Promise((c,n)=>{const b=new FileReader;b.onload=()=>c(b.result),b.onerror=n,b.readAsDataURL(t)})}function Qe(t){const c=(t||"").toLowerCase();return c.startsWith("image/")||["png","jpg","jpeg"].includes(c)}function st(t,c="TL"){return`â‚º${(typeof t=="number"?t:parseFloat(t)||0).toFixed(2)}`}const nt=["Backspace","Delete","Tab","Enter","Escape","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"],$e=[{id:"name",label:"MÃ¼ÅŸteri AdÄ±",type:"text",required:!0},{id:"company",label:"Åžirket",type:"text",required:!1},{id:"proj",label:"Proje AdÄ±",type:"text",required:!0},{id:"phone",label:"Telefon",type:"phone",required:!0},{id:"email",label:"E-posta",type:"email",required:!0}];function Rt({onSubmit:t,initialData:c=null,showNotification:n,t:b}){const[o,u]=ee.useState(!0),[d,k]=ee.useState(!1),[x,P]=ee.useState(null),[E,y]=ee.useState(()=>({...c||{},customFields:c&&c.customFields||{}})),[D,f]=ee.useState({}),[h,z]=ee.useState(!1),[V,O]=ee.useState({}),[j,L]=ee.useState(!1),[Q,te]=ee.useState(null),[ie,se]=ee.useState([]);ee.useEffect(()=>{console.log("ðŸ”§ DynamicFormRenderer: Component mounted")},[]),ee.useEffect(()=>{console.log("ðŸ”¥ FormData state updated:",E),window.formDataState=E},[E]),ee.useEffect(()=>{be()},[]),ee.useEffect(()=>{c&&y({...c,customFields:c.customFields||{}})},[c]);async function be(){console.log("ðŸ”§ DynamicFormRenderer: Loading form config...");try{u(!0);const i=await Y.getFormConfig();console.log("ðŸ”§ DynamicFormRenderer: Form config loaded successfully"),P(i.formConfig)}catch(i){console.error("ðŸ”§ DynamicFormRenderer: Load form config error:",i),n("Form konfigÃ¼rasyonu yÃ¼klenemedi","error")}finally{u(!1),console.log("ðŸ”§ DynamicFormRenderer: Loading completed")}}async function ae(i,g,S=!1){z(!0);try{const p=[];for(const C of Array.from(g)){const _=Ie(C.name);if(!je.includes(_)){n(`Desteklenmeyen dosya tÃ¼rÃ¼: ${_}`,"error");continue}if(C.size>_e*1024*1024){n(`Dosya Ã§ok bÃ¼yÃ¼k: ${C.name} (max ${_e}MB)`,"error");continue}const I=await Ye(C);p.push({name:C.name,size:C.size,type:C.type,dataUrl:I})}p.length>0&&(q(i,p,S),n(`${p.length} dosya yÃ¼klendi`,"success"))}catch(p){console.error("File upload error:",p),n("Dosya yÃ¼kleme hatasÄ±","error")}finally{z(!1)}}function ne(i,g){const S=i.type,p=i.validation||{},C=[];if(!g||g.toString().trim()==="")return i.required?{isValid:!1,error:"Bu alan zorunludur"}:{isValid:!0,error:null};switch(S){case"number":if(!/^-?\d*\.?\d*$/.test(g))return{isValid:!1,error:"Sadece sayÄ±sal deÄŸer girebilirsiniz"};const _=parseFloat(g);if(isNaN(_))return{isValid:!1,error:"GeÃ§erli bir sayÄ± giriniz"};p.min!==void 0&&_<p.min&&C.push(`Minimum deÄŸer: ${p.min}`),p.max!==void 0&&_>p.max&&C.push(`Maximum deÄŸer: ${p.max}`),p.integer&&!Number.isInteger(_)&&C.push("Tam sayÄ± giriniz (ondalÄ±k kullanmayÄ±n)"),p.positive&&_<=0&&C.push("Pozitif bir sayÄ± giriniz");break;case"email":if(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(g))return{isValid:!1,error:"GeÃ§erli bir e-posta adresi giriniz (Ã¶rn: ornek@email.com)"};if(p.allowedDomains&&p.allowedDomains.length>0){const ge=g.split("@")[1];p.allowedDomains.includes(ge)||C.push(`Sadece ÅŸu domainler kabul edilir: ${p.allowedDomains.join(", ")}`)}break;case"phone":const oe=g.replace(/[\s\-\(\)]/g,"");if(![/^(\+90|90)?[5][0-9]{9}$/,/^(\+90|90|0)?[2-4][0-9]{9}$/].some(ge=>ge.test(oe)))return{isValid:!1,error:"GeÃ§erli bir telefon numarasÄ± giriniz (Ã¶rn: +90 555 123 45 67 veya 0212 123 45 67)"};break;case"text":p.minLength&&g.length<p.minLength&&C.push(`En az ${p.minLength} karakter giriniz`),p.maxLength&&g.length>p.maxLength&&C.push(`En fazla ${p.maxLength} karakter girebilirsiniz`),p.onlyLetters&&!/^[a-zA-ZÄŸÃ¼ÅŸÄ±Ã¶Ã§ÄžÃœÅžÄ°Ã–Ã‡\s]+$/.test(g)&&C.push("Sadece harf girebilirsiniz"),p.noNumbers&&/\d/.test(g)&&C.push("SayÄ± karakteri kullanamaz"),p.alphanumeric&&!/^[a-zA-Z0-9ÄŸÃ¼ÅŸÄ±Ã¶Ã§ÄžÃœÅžÄ°Ã–Ã‡\s]+$/.test(g)&&C.push("Sadece harf ve sayÄ± kullanabilirsiniz"),p.pattern&&(new RegExp(p.pattern).test(g)||C.push(p.patternMessage||"GeÃ§ersiz format"));break;case"textarea":p.minLength&&g.length<p.minLength&&C.push(`En az ${p.minLength} karakter giriniz`),p.maxLength&&g.length>p.maxLength&&C.push(`En fazla ${p.maxLength} karakter girebilirsiniz`),p.minWords&&g.trim().split(/\s+/).length<p.minWords&&C.push(`En az ${p.minWords} kelime giriniz`),p.maxWords&&g.trim().split(/\s+/).length>p.maxWords&&C.push(`En fazla ${p.maxWords} kelime girebilirsiniz`);break;case"date":const re=new Date(g);if(isNaN(re.getTime()))return{isValid:!1,error:"GeÃ§erli bir tarih giriniz"};p.futureOnly&&re<=new Date&&C.push("Gelecekteki bir tarih seÃ§iniz"),p.pastOnly&&re>=new Date&&C.push("GeÃ§miÅŸteki bir tarih seÃ§iniz"),p.minDate&&re<new Date(p.minDate)&&C.push(`En erken ${p.minDate} tarihi seÃ§ebilirsiniz`),p.maxDate&&re>new Date(p.maxDate)&&C.push(`En geÃ§ ${p.maxDate} tarihi seÃ§ebilirsiniz`);break;case"dropdown":case"radio":if(i.options&&!i.options.includes(g))return{isValid:!1,error:"GeÃ§erli bir seÃ§enek seÃ§iniz"};break;case"multiselect":case"checkbox":p.minSelections&&Array.isArray(g)&&g.length<p.minSelections&&C.push(`En az ${p.minSelections} seÃ§enek seÃ§iniz`),p.maxSelections&&Array.isArray(g)&&g.length>p.maxSelections&&C.push(`En fazla ${p.maxSelections} seÃ§enek seÃ§ebilirsiniz`);break;case"file":g&&typeof g=="object"&&g.size&&(p.maxSize&&g.size>p.maxSize&&C.push(`Dosya boyutu en fazla ${(p.maxSize/(1024*1024)).toFixed(1)} MB olabilir`),p.allowedTypes&&!p.allowedTypes.includes(g.type)&&C.push(`Sadece ÅŸu dosya tÃ¼rleri kabul edilir: ${p.allowedTypes.join(", ")}`));break}return{isValid:C.length===0,error:C.length>0?C[0]:null}}function ce(i,g){return i}function q(i,g,S=!1,p=null){console.log("ðŸš€ handleFieldChange called:",{fieldId:i,value:g,isCustomField:S,fieldType:p?.type});const C=S?E.customFields?.[i]:E[i];C!==g&&console.log("ðŸ”¥ Field value changed:",{fieldId:i,oldValue:C,newValue:g});let _=g;if(p&&(_=ce(g)),y(S?I=>({...I,customFields:{...I.customFields,[i]:_}}):I=>({...I,[i]:_})),p){const I=ne(p,_);f(oe=>{const ue={...oe};return I.isValid?delete ue[i]:ue[i]=I.error,ue})}}function Z(){const i={},g=x?.fields||x?.formStructure?.fields||[];return[...$e,...g].forEach(p=>{const _=!$e.some(oe=>oe.id===p.id)?E.customFields?.[p.id]:E[p.id],I=ne(p,_);I.isValid||(i[p.id]=I.error)}),f(i),Object.keys(i).length===0}async function he(i){if(i.preventDefault(),!Z()){n("LÃ¼tfen form hatalarÄ±nÄ± dÃ¼zeltin","error");return}try{k(!0);const S={id:Ke(),createdAt:new Date().toISOString(),status:"new",name:E.name,company:E.company,proj:E.proj,phone:E.phone,email:E.email,customFields:E.customFields||{},formVersion:x?.version,formConfigSnapshot:x};await t(S),n("Teklif baÅŸarÄ±yla gÃ¶nderildi!","success"),y({customFields:{}}),f({})}catch(S){console.error("Submit error:",S),n("Form gÃ¶nderilemedi. LÃ¼tfen tekrar deneyin.","error")}finally{k(!1)}}if(o)return e.createElement("div",{className:"loading-state"},e.createElement("div",{style:{textAlign:"center",padding:"40px"}},e.createElement("p",null,"Form yÃ¼kleniyor..."),e.createElement("p",{style:{fontSize:"12px",color:"#666"}},"Form konfigÃ¼rasyonu API'den alÄ±nÄ±yor...")));if(!o&&!x)return e.createElement("div",{className:"error-state"},e.createElement("div",{style:{textAlign:"center",padding:"40px"}},e.createElement("p",{style:{color:"red"}},"Form konfigÃ¼rasyonu yÃ¼klenemedi"),e.createElement("p",{style:{fontSize:"12px",color:"#666"}},"LÃ¼tfen sayfayÄ± yenileyin veya admin ile iletiÅŸime geÃ§in.")));function pe(i,g=!1){const S=i.id,p=g?E.customFields?.[S]:E[S],C=D[S],_=V[S],I=p?ne(i,p):null,oe=!!(p&&I&&I.isValid),ue={id:S,name:S,"data-field-id":S,className:C?"error":_?"warning":p?"valid":"",tabIndex:0,autoComplete:"off",onChange:B=>{console.log("ðŸ“ Input onChange event:",{fieldId:S,value:B.target.value});const N=B.target.value;q(S,N,g,i),V[S]&&ne(i,N).isValid&&O(a=>{const l={...a};return delete l[S],l}),D[S]&&ne(i,N).isValid&&f(a=>{const l={...a};return delete l[S],l})},onKeyDown:B=>{const N=B.ctrlKey||B.metaKey;if(B.key==="Enter"||B.key==="Tab"){const R=ne(i,B.currentTarget.value);f(a=>{const l={...a};return R.isValid?delete l[S]:l[S]=R.error,l}),O(a=>{const l={...a};return delete l[S],l});return}if(!N&&!nt.includes(B.key)&&B.key.length===1){const R=B.key;if(i.type==="phone"&&(/[0-9\s()\-]/.test(R)||R==="+"&&B.currentTarget.selectionStart===0&&!B.currentTarget.value.includes("+")||(B.preventDefault(),O(l=>({...l,[S]:"Telefon alanÄ± yalnÄ±zca sayÄ± ve (+) gibi sembolleri kabul eder"})))),i.type==="text"){const a=i.validation?.onlyLetters,l=i.validation?.noNumbers;a?/[a-zA-ZÄŸÃ¼ÅŸÄ±Ã¶Ã§ÄžÃœÅžÄ°Ã–Ã‡\s]/.test(R)||(B.preventDefault(),O(w=>({...w,[S]:"Sadece harf girebilirsiniz"}))):l&&/\d/.test(R)&&(B.preventDefault(),O(w=>({...w,[S]:"SayÄ± karakteri kullanamaz"})))}}},onBlur:B=>{const N=ne(i,B.target.value);N.isValid?f(R=>{const a={...R};return delete a[S],a}):f(R=>({...R,[S]:N.error})),O(R=>{const a={...R};return delete a[S],a})}};function xe(B){const N=B.placeholder||B.label||"",R=B.validation||{};if(B.type==="number"){const a=[];return R.min!==void 0&&a.push(`min: ${R.min}`),R.max!==void 0&&a.push(`max: ${R.max}`),R.integer&&a.push("int"),a.length?`${N} (${a.join(", ")})`:N}if(B.type==="text"||B.type==="textarea"){const a=[];return R.minLength&&a.push(`min ${R.minLength}`),R.maxLength&&a.push(`max ${R.maxLength}`),a.length?`${N} (${a.join(", ")})`:N}return N}let re;switch(i.type){case"text":case"email":case"phone":re=e.createElement("input",{...ue,type:i.type==="phone"?"tel":i.type,value:p||"",placeholder:xe(i),maxLength:i.validation?.maxLength,minLength:i.validation?.minLength,autoFocus:i.autoFocus||!1});break;case"textarea":re=e.createElement("textarea",{...ue,value:p||"",placeholder:xe(i),rows:3,maxLength:i.validation?.maxLength});break;case"number":re=e.createElement("input",{...ue,type:"text",inputMode:i.validation?.integer?"numeric":"decimal",value:p||"",placeholder:xe(i),"data-min":i.validation?.min,"data-max":i.validation?.max,"data-integer":i.validation?.integer||!1,onKeyDown:N=>{if(!(N.ctrlKey||N.metaKey)&&!nt.includes(N.key)&&N.key.length===1){const a=/[0-9]/.test(N.key),l=N.key===".",s=N.key==="-",w=!i.validation?.integer,H=!i.validation?.positive&&N.currentTarget.selectionStart===0&&!N.currentTarget.value.includes("-");if(!a&&!(l&&w)&&!(s&&H)){N.preventDefault(),O(me=>({...me,[S]:"Sadece sayÄ±sal karakter girebilirsiniz"}));return}}if(N.key==="Enter"||N.key==="Tab"){const a=ne(i,N.currentTarget.value);f(l=>{const s={...l};return a.isValid?delete s[S]:s[S]=a.error,s}),O(l=>{const s={...l};return delete s[S],s})}},onPaste:N=>{setTimeout(()=>{const R=(N.clipboardData||window.clipboardData).getData("text"),a=ce(R);a!==R&&q(S,a,g,i)},0)},title:(()=>{const N=[];return i.validation?.min!==void 0&&N.push(`Min: ${i.validation.min}`),i.validation?.max!==void 0&&N.push(`Max: ${i.validation.max}`),i.validation?.integer&&N.push("Tam sayÄ±"),i.validation?.positive&&N.push("Pozitif sayÄ±"),N.length>0?N.join(", "):""})()});break;case"date":re=e.createElement("input",{...ue,type:"date",value:p||""});break;case"dropdown":re=e.createElement("select",{...ue,value:p||""},e.createElement("option",{value:""},i.placeholder||`${i.label} seÃ§in`),i.options?.map(N=>e.createElement("option",{key:N,value:N},N)));break;case"radio":re=e.createElement("div",{className:"radio-group"},i.options?.map(N=>e.createElement("label",{key:N,className:"radio-option"},e.createElement("input",{type:"radio",name:S,value:N,checked:p===N,onChange:R=>q(S,R.target.value,g)}),e.createElement("span",null,N))));break;case"multiselect":case"checkbox":i.type==="checkbox"&&i.options?.length===1?re=e.createElement("label",{className:"checkbox-single"},e.createElement("input",{type:"checkbox",checked:!!p,onChange:N=>q(S,N.target.checked,g)}),e.createElement("span",null,i.options[0])):re=e.createElement("div",{className:"checkbox-group"},i.options?.map(N=>e.createElement("label",{key:N,className:"checkbox-option"},e.createElement("input",{type:"checkbox",value:N,checked:Array.isArray(p)?p.includes(N):!1,onChange:R=>{const a=Array.isArray(p)?p:[],l=R.target.checked?[...a,N]:a.filter(s=>s!==N);q(S,l,g)}}),e.createElement("span",null,N))));break;case"file":const B=g?E.customFields?.[S]:E[S];re=e.createElement("div",{className:"file-upload-container"},e.createElement("div",{className:"file-upload-area",onDragOver:N=>{N.preventDefault(),N.currentTarget.classList.add("dragover")},onDragLeave:N=>{N.currentTarget.classList.remove("dragover")},onDrop:N=>{N.preventDefault(),N.currentTarget.classList.remove("dragover"),ae(S,N.dataTransfer.files,g)},onClick:()=>document.getElementById(`file-input-${S}`).click()},e.createElement("input",{id:`file-input-${S}`,type:"file",multiple:!0,accept:je.map(N=>`.${N}`).join(","),style:{display:"none"},onChange:N=>ae(S,N.target.files,g)}),e.createElement("div",{className:"upload-text"},h?"YÃ¼kleniyor...":"Dosya seÃ§in veya sÃ¼rÃ¼kleyip bÄ±rakÄ±n",e.createElement("div",{className:"upload-help"},`Desteklenen formatlar: ${je.join(", ")}`))),B&&B.length>0&&e.createElement("div",{className:"file-preview"},B.map((N,R)=>e.createElement("div",{key:R,className:"file-item"},e.createElement("div",{className:"file-icon"},Qe(N.type)?e.createElement("img",{src:N.dataUrl,alt:N.name,style:{width:"40px",height:"40px",objectFit:"cover"}}):e.createElement("span",null,Ie(N.name).toUpperCase())),e.createElement("div",{className:"file-info"},e.createElement("div",{className:"file-name"},N.name),e.createElement("div",{className:"file-size"},`${(N.size/1024).toFixed(1)} KB`)),e.createElement("button",{type:"button",className:"btn-remove",onClick:()=>{const a=B.filter((l,s)=>s!==R);q(S,a,g)}},"Ã—")))));break;default:re=e.createElement("input",{...ue,type:"text",value:p||"",placeholder:i.placeholder||i.label})}return e.createElement("div",{key:S,className:`field ${C?"error":""}`},e.createElement("label",{htmlFor:S,className:"field-label"},i.label,i.required&&e.createElement("span",{className:"required"}," *"),C||_?e.createElement("span",{className:`field-status ${C?"error":"warning"}`},C||_):oe?e.createElement("span",{className:"field-status success",title:"GeÃ§erli"},"âœ“"):null),e.createElement("div",{className:"input-container",style:{position:"relative"}},re,null,null),null)}if(o)return e.createElement("div",{className:"loading"},"Form yÃ¼kleniyor...");if(!x)return e.createElement("div",{className:"error"},"Form konfigÃ¼rasyonu bulunamadÄ±");const X=$e.map((i,g)=>({...i,display:{formOrder:g+1},autoFocus:g===0})),Ee=(x?.fields||x?.formStructure?.fields||[]).map((i,g)=>({...i,display:{...i.display,formOrder:i.display?.formOrder??10+g}})),Ne=[...X].sort((i,g)=>(i.display?.formOrder||0)-(g.display?.formOrder||0)),ve=[...Ee].sort((i,g)=>(i.display?.formOrder||0)-(g.display?.formOrder||0));function m(){const i=[...Ne,...ve],g=[];return i.forEach(S=>{const C=!$e.some(I=>I.id===S.id)?E.customFields?.[S.id]:E[S.id],_=Array.isArray(C)?C.length===0:C==null||String(C).trim()==="";!S.required&&_&&g.push({id:S.id,label:S.label})}),g}async function T(i){await t(i),n("Teklif baÅŸarÄ±yla gÃ¶nderildi!","success"),y({customFields:{}}),f({})}return he=async function(i){if(i.preventDefault(),!Z()){n("LÃ¼tfen form hatalarÄ±nÄ± dÃ¼zeltin","error");return}try{k(!0);const S={id:Ke(),createdAt:new Date().toISOString(),status:"new",name:E.name,company:E.company,proj:E.proj,phone:E.phone,email:E.email,customFields:E.customFields||{},formVersion:x?.version,formConfigSnapshot:x,lang:localStorage.getItem("bk_lang")||"tr"},p=m();if(p.length>0){se(p),te(S),L(!0),k(!1);return}await T(S)}catch(S){console.error("Submit error:",S),n("Form gÃ¶nderilemedi. LÃ¼tfen tekrar deneyin.","error")}finally{k(!1)}},e.createElement("div",{className:"container"},e.createElement("form",{onSubmit:he,className:"dynamic-form two-col"},e.createElement("div",{className:"form-section fixed-fields"},e.createElement("div",{className:"section-card"},(()=>{const i=localStorage.getItem("bk_lang")||"tr",g=i==="en"?"Customer Information":"MÃ¼ÅŸteri Bilgileri",S=i==="en"?"Fields marked * are required":"* iÅŸaretli alanlar zorunludur";return e.createElement(e.Fragment,null,e.createElement("div",{className:"section-title"},g),e.createElement("div",{className:"required-note"},S))})(),e.createElement("div",{className:"form-grid"},Ne.map(i=>pe(i,!1))))),e.createElement("div",{className:"form-section custom-fields"},e.createElement("div",{className:"section-card"},(()=>{const g=(localStorage.getItem("bk_lang")||"tr")==="en"?"Additional Fields":"Form AlanlarÄ±";return e.createElement("div",{className:"section-title"},g)})(),e.createElement("div",{className:"form-grid"},ve.map(i=>pe(i,!0))))),e.createElement("div",{className:"form-actions"},e.createElement("button",{type:"submit",className:"btn accent",disabled:d},d?"GÃ¶nderiliyor...":"Teklif GÃ¶nder")),j&&e.createElement("div",{className:"modal-overlay","data-backdrop":"true",onClick:()=>L(!1)},e.createElement("div",{className:"modal",onClick:i=>i.stopPropagation()},e.createElement("div",{className:"modal-header"},(()=>{const g=(localStorage.getItem("bk_lang")||"tr")==="en"?"There are fields left empty":"BoÅŸ bÄ±rakÄ±lan alanlar var";return e.createElement("h3",null,g)})()),e.createElement("div",{className:"modal-body"},(()=>{const g=(localStorage.getItem("bk_lang")||"tr")==="en"?"Would you like to review the empty fields before submitting?":"BoÅŸ bÄ±rakÄ±lan alanlarÄ± tekrar gÃ¶zden geÃ§irmek ister misiniz?";return e.createElement("p",null,g)})(),e.createElement("div",{style:{maxHeight:200,overflow:"auto",marginTop:8}},e.createElement("ul",null,ie.map(i=>e.createElement("li",{key:i.id},i.label))))),e.createElement("div",{className:"modal-footer"},e.createElement("button",{type:"button",className:"btn secondary",onClick:()=>L(!1)},(localStorage.getItem("bk_lang")||"tr")==="en"?"Review fields":"AlanlarÄ± gÃ¶zden geÃ§ir"),e.createElement("button",{type:"button",className:"btn primary",onClick:async()=>{const i=Q;L(!1),te(null),await T(i)}},(localStorage.getItem("bk_lang")||"tr")==="en"?"Continue and submit":"Devam et ve gÃ¶nder"))))))}const Ce=st||function(t,c="TL"){return`â‚º${(typeof t=="number"?t:parseFloat(t)||0).toFixed(2)}`};function zt(t){switch(t){case"price-changed":return"#dc3545";case"formula-changed":return"#ffc107";default:return"#6c757d"}}function Bt(t){switch(t){case"price-changed":return"white";case"formula-changed":return"#000";default:return"white"}}function $t(t){switch(t){case"price-changed":return"Fiyat deÄŸiÅŸti - Yeni hesaplama mevcut fiyattan farklÄ±";case"formula-changed":return"FormÃ¼l deÄŸiÅŸti - Parametre veya formÃ¼l gÃ¼ncellendi ama fiyat aynÄ± kaldÄ±";default:return"Fiyat durumu belirsiz"}}function jt(t){switch(t){case"price-changed":return"!";case"formula-changed":return"~";default:return"?"}}function _t(t){const c=[{id:"date",label:"Tarih",type:"date"},{id:"name",label:"MÃ¼ÅŸteri",type:"text"},{id:"company",label:"Åžirket",type:"text"},{id:"proj",label:"Proje",type:"text"},{id:"phone",label:"Telefon",type:"phone"},{id:"email",label:"E-posta",type:"email"}],b=(t?.fields||t?.formStructure?.fields||[]).filter(u=>u.display?.showInTable).sort((u,d)=>(u.display?.tableOrder||0)-(d.display?.tableOrder||0)),o=[{id:"price",label:"Tahmini Fiyat",type:"currency"},{id:"due",label:"Termine Kalan",type:"text"},{id:"status",label:"Durum",type:"text"}];return[...c,...b,...o]}function rt(t,c){return["date","name","company","proj","phone","email","price","due","status"].includes(c)?c==="date"?t.createdAt||t.date||"":t[c]||"":t.customFields?.[c]||""}function It(t,c,n,b){if(t=(u=>u==null?"":Array.isArray(u)?u.join(", "):typeof u=="object"?JSON.stringify(u):u)(t),b){const{getPriceChangeType:u,openPriceReview:d,calculatePrice:k,statusLabel:x,t:P}=b;switch(c.id){case"date":return(t||"").slice(0,10);case"customer":return(n.name||"")+(n.company?" â€” "+n.company:"");case"project":const E=t||"";return E.length>15?E.substring(0,15)+"...":E;case"price":const y=n?.priceStatus||null,D=u(n),f=y?.status,h=y?.differenceSummary||null;if(n?.manualOverride?.active===!0||f==="manual")return e.createElement("span",{style:{color:"var(--text, #f8fafc)",fontWeight:"normal"},title:"Bu fiyat manuel olarak kilitlendi"},`${Ce(parseFloat(t)||0)}ðŸ”’`);if(!(["price-drift","content-drift","outdated","unknown","error"].includes(f)||!!D))return Ce(parseFloat(t)||0);const O=h?.oldPrice??(parseFloat(n.price)||0),j=typeof k=="function"?parseFloat(k(n))||0:n.pendingCalculatedPrice!==void 0&&parseFloat(n.pendingCalculatedPrice)||0,L=h?.newPrice??(parseFloat(y?.calculatedPrice)||j||O);let Q="#ffc107";(f==="price-drift"||f==="content-drift"||D==="price-changed")&&(Q="#dc3545"),h||(Q="#ffc107");const te=Number(h?.priceDiff??L-O),ie=h?`Fark: â‚º${te.toFixed(2)} (${Ce(O)} â†’ ${Ce(L)})`:"Fiyat ayarlarÄ± deÄŸiÅŸti",se=h?.reasons?.length?`
${h.reasons.join(`
`)}`:"",be=`${ie}${se}`;return e.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},e.createElement("span",null,Ce(parseFloat(t)||0)),e.createElement("div",{style:{display:"inline-block",width:"8px",height:"8px",borderRadius:"50%",backgroundColor:Q},title:be}),e.createElement("button",{onClick:ce=>{ce.stopPropagation(),typeof d=="function"&&d(n,{originalPrice:O,newPrice:L,differenceSummary:h})},style:{backgroundColor:zt(D||(["price-drift","content-drift"].includes(f)?"price-changed":"formula-changed")),color:Bt(D||(["price-drift","content-drift"].includes(f)?"price-changed":"formula-changed")),border:"none",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",cursor:"pointer",fontWeight:"bold"},title:$t(D||(["price-drift","content-drift"].includes(f)?"price-changed":"formula-changed"))},jt(D||(["price-drift","content-drift"].includes(f)?"price-changed":"formula-changed"))));case"due":const ae=t||"";return ae.includes("Gecikti")?e.createElement("span",{style:{color:"#dc3545",fontWeight:"bold"}},ae):ae.includes("gÃ¼n")&&parseInt(ae.match(/\d+/)?.[0]||"0")<=3?e.createElement("span",{style:{color:"#ffc107",fontWeight:"bold"}},ae):ae;case"status":const ne=x(t||"new",P);return e.createElement("span",{style:{padding:"2px 8px",borderRadius:"12px",fontSize:"11px",fontWeight:"bold",backgroundColor:Mt(t),color:Ot(t)}},ne);default:return c.type==="currency"?Ce(parseFloat(t)||0):c.type==="email"?e.createElement("a",{href:`mailto:${t}`,style:{color:"#007bff"}},t):c.type==="phone"?e.createElement("a",{href:`tel:${t}`,style:{color:"#007bff"}},t):t||""}}return c.type==="currency"?Ce(parseFloat(t)||0):c.type==="date"?(t||"").slice(0,10):t||""}function Mt(t){switch(t){case"new":return"#e3f2fd";case"pending":return"#fff3e0";case"approved":return"#e8f5e8";case"rejected":return"#ffebee";case"completed":return"#f3e5f5";default:return"#f5f5f5"}}function Ot(t){switch(t){case"new":return"#1976d2";case"pending":return"#f57c00";case"approved":return"#388e3c";case"rejected":return"#d32f2f";case"completed":return"#7b1fa2";default:return"#666"}}function ct(t,c){return Y.calculatePriceLocal(t,c)}function Lt(t,c){const n=t?.priceStatus?.status,b=t?.priceStatus?.differenceSummary,o=b&&typeof b.priceDiff=="number"?Math.abs(b.priceDiff):0;if(n==="price-drift")return"price-changed";if(n==="content-drift")return o>.01?"price-changed":"formula-changed";if(["outdated","unknown","error"].includes(n))return"formula-changed";if(!t||!c)return null;if(t.priceChangeType)return t.priceChangeType;try{const u=parseFloat(t.calculatedPrice)||0,d=ct(t,c);return Math.abs(u-d)>.01?"price-changed":null}catch(u){return console.error("âŒ Local price calculation failed:",u),null}}const{useMemo:ut}=e;function Vt(t,c,n,b){return ut(()=>t.filter(o=>{if(n){const u=n.toLowerCase(),d=[o.name,o.company,o.proj,o.email,o.phone,o.material,o.finish,o.status,o.country,o.dims,o.dimsL,o.dimsW,o.thickness,o.qty,o.notes,o.createdBy,o.price,o.calculatedPrice],k=Array.isArray(o.process)?o.process:[o.process].filter(Boolean),x=o.customFields?Object.values(o.customFields):[],P=o.files?o.files.map(y=>y.name||y.originalName||""):[];if(![...d,...k,...x,...P].filter(Boolean).join(" ").toLowerCase().includes(u))return!1}if(c.status&&c.status.length>0&&!c.status.includes(o.status))return!1;if(b&&b.steps){for(const u of b.steps)for(const d of u.fields)if(d.filterable&&c[d.id]&&c[d.id].length>0){const k=o[d.id];if(d.type==="multiselect"){const x=Array.isArray(k)?k:typeof k=="string"?k.split(",").map(E=>E.trim()):[];if(!c[d.id].some(E=>x.includes(E)))return!1}else if(!c[d.id].includes(k))return!1}}if(c.dateRange&&(c.dateRange.from||c.dateRange.to)){const u=new Date(o.createdAt);if(c.dateRange.from){const d=new Date(c.dateRange.from);if(u<d)return!1}if(c.dateRange.to){const d=new Date(c.dateRange.to);if(d.setHours(23,59,59,999),u>d)return!1}}if(c.qtyRange&&(c.qtyRange.min||c.qtyRange.max)){const u=parseFloat(o.qty)||0;if(c.qtyRange.min&&u<parseFloat(c.qtyRange.min)||c.qtyRange.max&&u>parseFloat(c.qtyRange.max))return!1}return!0}),[t,c,n])}function Ut(t,c){return ut(()=>{const n={status:[...new Set(t.map(b=>b.status).filter(Boolean))]};return c&&c.steps&&c.steps.forEach(b=>{b.fields.forEach(o=>{o.filterable&&o.type!=="textarea"&&o.type!=="date"&&o.type!=="number"&&(o.type==="multiselect"?n[o.id]=[...new Set(t.flatMap(u=>Array.isArray(u[o.id])?u[o.id]:typeof u[o.id]=="string"?u[o.id].split(",").map(d=>d.trim()):[]).filter(Boolean))]:o.type==="radio"&&o.options?n[o.id]=[...new Set(t.map(u=>u[o.id]).filter(Boolean))]:n[o.id]=[...new Set(t.map(u=>u[o.id]).filter(Boolean))])})}),n},[t,c])}function Wt(t,c,n,b,o="toggle"){c(u=>{const d={...u};if(n==="dateRange"||n==="qtyRange")d[n]={...u[n],...b};else{const k=u[n]||[];o==="toggle"?k.includes(b)?d[n]=k.filter(x=>x!==b):d[n]=[...k,b]:o==="add"?k.includes(b)||(d[n]=[...k,b]):o==="remove"&&(d[n]=k.filter(x=>x!==b))}return d})}function qt(t,c){t({status:[],material:[],process:[],dateRange:{from:"",to:""},qtyRange:{min:"",max:""},country:[]}),c("")}function Gt(t,c){t(n=>{const b={...n};return b[c]=[],b})}function Ue(t){let c=0;return Object.keys(t).forEach(n=>{(Array.isArray(t[n])&&t[n].length>0||n==="dateRange"&&(t[n].from||t[n].to)||n==="qtyRange"&&(t[n].min||t[n].max))&&c++}),c}function lt(t,c="count"){const n={total:t.length,byStatus:{},byMaterial:{},byProcess:{},byMonth:{},totalValue:0,avgValue:0};let b=0;t.forEach(u=>{const d=parseFloat(u.price)||0;b+=d}),n.totalValue=b,n.avgValue=t.length>0?b/t.length:0,t.forEach(u=>{const d=u.status||"unknown";n.byStatus[d]||(n.byStatus[d]={count:0,value:0}),n.byStatus[d].count++,n.byStatus[d].value+=parseFloat(u.price)||0}),t.forEach(u=>{const d=u.material||"unknown";n.byMaterial[d]||(n.byMaterial[d]={count:0,value:0}),n.byMaterial[d].count++,n.byMaterial[d].value+=parseFloat(u.price)||0}),t.forEach(u=>{const d=Array.isArray(u.process)?u.process:[u.process].filter(Boolean);d.forEach(k=>{n.byProcess[k]||(n.byProcess[k]={count:0,value:0}),n.byProcess[k].count++,n.byProcess[k].value+=(parseFloat(u.price)||0)/d.length})}),t.forEach(u=>{const k=(u.createdAt||u.date||"").slice(0,7);k&&(n.byMonth[k]||(n.byMonth[k]={count:0,value:0}),n.byMonth[k].count++,n.byMonth[k].value+=parseFloat(u.price)||0)});const o=u=>Object.entries(u).map(([d,k])=>({label:d,count:k.count,value:k.value})).sort((d,k)=>c==="value"?k.value-d.value:k.count-d.count);return n.byStatus=o(n.byStatus),n.byMaterial=o(n.byMaterial),n.byProcess=o(n.byProcess),n.byMonth=o(n.byMonth).sort((u,d)=>u.label.localeCompare(d.label)),n}function We({data:t,xLabel:c,yLabel:n,byKeyAlpha:b=!1}){if(!t||t.length===0)return e.createElement("div",{style:{padding:"20px",textAlign:"center",color:"#666",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f9f9f9"}},"Veri bulunamadÄ±");const o=b?[...t].sort((E,y)=>E.label.localeCompare(y.label)):t,u=Math.max(...o.map(E=>n.includes("Toplam")?E.value:E.count)),d=200,k=400,x={top:20,right:20,bottom:60,left:60},P=Math.max(20,(k-x.left-x.right)/o.length-10);return e.createElement("div",{style:{border:"1px solid #ddd",borderRadius:"8px",padding:"16px",backgroundColor:"white"}},e.createElement("h4",{style:{margin:"0 0 16px 0",fontSize:"14px",color:"#333",textAlign:"center"}},`${c} - ${n}`),e.createElement("div",{style:{position:"relative",height:d+x.top+x.bottom,overflow:"auto"}},e.createElement("svg",{width:Math.max(k,o.length*(P+10)+x.left+x.right),height:d+x.top+x.bottom,style:{display:"block"}},e.createElement("line",{x1:x.left,y1:x.top,x2:x.left,y2:d+x.top,stroke:"#333",strokeWidth:1}),e.createElement("line",{x1:x.left,y1:d+x.top,x2:o.length*(P+10)+x.left,y2:d+x.top,stroke:"#333",strokeWidth:1}),...o.map((E,y)=>{const D=n.includes("Toplam")?E.value:E.count,f=u>0?D/u*d:0,h=x.left+y*(P+10)+5,z=x.top+d-f;return e.createElement("g",{key:E.label},e.createElement("rect",{x:h,y:z,width:P,height:f,fill:Kt(y),stroke:"#333",strokeWidth:1}),e.createElement("text",{x:h+P/2,y:z-5,textAnchor:"middle",fontSize:"10px",fill:"#333"},n.includes("Toplam")?st(D):D),e.createElement("text",{x:h+P/2,y:d+x.top+15,textAnchor:"middle",fontSize:"10px",fill:"#333",transform:`rotate(-45, ${h+P/2}, ${d+x.top+15})`},E.label.length>10?E.label.substring(0,10)+"...":E.label))}),e.createElement("text",{x:15,y:x.top+d/2,textAnchor:"middle",fontSize:"12px",fill:"#333",transform:`rotate(-90, 15, ${x.top+d/2})`},n))))}function Kt(t){const c=["#007bff","#28a745","#ffc107","#dc3545","#6c757d","#17a2b8","#fd7e14","#e83e8c","#6f42c1","#20c997"];return c[t%c.length]}function Yt({item:t,onClose:c,setItemStatus:n,onSaved:b,t:o,isNew:u,showNotification:d,formConfig:k,globalProcessing:x,setGlobalProcessing:P,checkAndProcessVersionUpdates:E,currentQuotes:y}){console.log("ðŸ”§ DEBUG: DetailModal rendered with item:",t?.id,"formConfig:",!!k);const[D,f]=e.useState(t.status||"new"),[h,z]=e.useState(!!u),[V,O]=e.useState({}),[j,L]=e.useState(t.files||[]),[Q,te]=e.useState(t.productImages||[]),[ie,se]=e.useState(t.manualOverride||null),[be,ae]=e.useState(()=>g(t.manualOverride?.price??t.price)),[ne,ce]=e.useState(t.manualOverride?.note||""),[q,Z]=e.useState(!1),[he,pe]=e.useState(!1),[X,Se]=e.useState(null);e.useEffect(()=>{f(t.status||"new");const a={};k&&k.formStructure&&k.formStructure.fields&&k.formStructure.fields.forEach(w=>{let H=t.customFields?.[w.id]||t.customFields?.[w.id]||t[w.id]||"";w.type==="multiselect"&&Array.isArray(H)?H=H.join(", "):w.type==="radio"&&!H&&(H=w.options?.[0]||""),a[w.id]=H}),O(a),L(t.files||[]),te(t.productImages||[]);const l=t.manualOverride||null;se(l);const s=l?.price??t.price;ae(g(s)),ce(l?.note||"")},[t.id,t.status,t.price,t.manualOverride]);function Ee(a,l){O(s=>({...s,[a]:l}))}function Ne(){if(!k||!k.formStructure.fields)return[];const a=[];return k.formStructure.fields.forEach(l=>{const s=l.label||l.id;l.type==="textarea"?a.push(N(s,l.id)):l.type==="radio"&&l.options?a.push(R(s,l.id,l.options)):l.type==="multiselect"?a.push(B(s,l.id)):a.push(B(s,l.id,l.type==="number"?"number":"text"))}),a}function ve(){if(!k||!k.formStructure.fields)return[];const a=[];return a.push(de("ID",t.id),de(o.th_date||"Tarih",(t.createdAt||"").replace("T"," ").slice(0,16)),de(o.a_status||"Durum",Ge(D,o))),k.formStructure.fields.forEach(l=>{let s=t.customFields?.[l.id]||t[l.id]||"â€”",w=l.label||l.id;if(l.type==="multiselect"&&Array.isArray(t.customFields?.[l.id]||t[l.id])?s=t.customFields?.[l.id]||t[l.id].join(", ")||"â€”":l.type==="radio"&&l.options?s=s||"â€”":l.type==="number"?s=s?s+(l.unit||""):"â€”":l.type==="date"||l.type==="textarea"?s=s||"â€”":(!s||s==="")&&(s="â€”"),l.id==="thickness"&&s!=="â€”")s=s+" mm";else if(l.id==="country"||l.id==="city"){const H=t.country||"undefined",me=t.city||"undefined";if(l.id==="country")s=`${H} / ${me}`,w=(o.f_country||"Ãœlke")+"/"+(o.f_city||"Åžehir");else if(l.id==="city")return null}else l.id==="repeat"&&(s=s==="recurrent"?o.repeat_recurrent||"SÃ¼rekli":o.repeat_one||"Tek Seferlik");s!==null&&a.push(de(w,s))}),a.filter(Boolean)}const m=!!(ie&&ie.active),T=ie?.setAt?new Date(ie.setAt).toLocaleString("tr-TR"):null,i=ie?.setByLabel||ie?.setBy||null;function g(a){if(a==null||a==="")return"";const l=Number(String(a).replace(",","."));return Number.isNaN(l)?"":l.toFixed(2)}function S(a){return a==null||a===""?NaN:Number(String(a).replace(",","."))}function p(a){const l=S(a);return Number.isNaN(l)?"â€”":`â‚º${l.toFixed(2)}`}async function C(){if(!t||!t.id)return;const a=S(be);if(Number.isNaN(a)||a<0){d?.("GeÃ§erli bir fiyat giriniz","error");return}Z(!0);try{const l=await Y.setManualPrice(t.id,{price:a,note:ne}),s=l?.quote||l||{};se(s.manualOverride||{active:!0,price:a,note:ne}),ae(g(s.manualOverride?.price??a)),ce(s.manualOverride?.note||ne),d?.("Fiyat manuel olarak kilitlendi","success"),typeof b=="function"&&await b(),E&&P&&await E(y)}catch(l){console.error("Manual price save error:",l),d?.(`Manuel fiyat kaydedilemedi: ${l.message||"Beklenmeyen hata"}`,"error")}finally{Z(!1)}}function _(){if(!t.priceStatus||!t.priceStatus.calculatedPrice)return;const a=parseFloat(t.price)||0,l=parseFloat(t.priceStatus.calculatedPrice)||0,s=l-a,w=t.priceStatus?.versionInfo||{},H=w.originalVersion||"Bilinmiyor",me=w.currentVersion||"Bilinmiyor",ke=w.latestVersion||"Bilinmiyor",De=w.comparisonBasis||"Mevcut â†’ GÃ¼ncel",ye=w.parameterChanges||[];Se({customerName:t.name||"Bilinmiyor",projectName:t.proj||"Bilinmiyor",currentPrice:a,newPrice:l,priceDifference:s,originalVersion:H,currentVersion:me,latestVersion:ke,comparisonBasis:De,parameterChanges:ye}),pe(!0)}async function I(a=!1){if(console.log("ï¿½ handleManualRelease STARTED with applyLatest:",a),console.log("ðŸ”´ item:",t),console.log("ðŸ”´ item.id:",t?.id),console.log("ðŸ”´ manualLoading before:",q),!t||!t.id){console.log("ðŸ”´ ERROR: No item or item.id");return}console.log("ðŸ”´ Setting manualLoading to true"),Z(!0);try{console.log("ï¿½ Clearing manual price...");const l=await Y.clearManualPrice(t.id,a?"Manuel fiyat kilidi kaldÄ±rÄ±ldÄ± ve gÃ¼ncel sÃ¼rÃ¼m uygulandÄ±":"Manuel fiyat kilidi kaldÄ±rÄ±ldÄ±");console.log("ï¿½ Clear manual price response:",l);const s=l?.quote||l||{};if(se(s.manualOverride||{active:!1}),ae(g(s.manualOverride?.price??s.price??"")),ce(s.manualOverride?.note||""),a){console.log("ðŸ”§ Applying current price...");const w=await Y.applyCurrentPriceToQuote(t.id);if(console.log("ðŸ”§ Apply current price response:",w),!w||w.success===!1)throw new Error(w?.error||"GÃ¼ncel fiyat uygulanamadÄ±")}console.log("ðŸ”§ Operation completed successfully"),d?.(a?"Kilit kaldÄ±rÄ±ldÄ± ve gÃ¼ncel fiyat uygulandÄ±":"Manuel kilit kaldÄ±rÄ±ldÄ±","success"),typeof b=="function"?(console.log("ðŸ”§ Calling onSaved function..."),await b(),console.log("ðŸ”§ onSaved completed")):console.log("ðŸ”§ No onSaved function provided"),E&&P&&(console.log("ðŸ”§ Checking for version updates..."),await E(),console.log("ðŸ”§ Version updates check completed"))}catch(l){console.error("Manual override release error:",l),d?.(`Ä°ÅŸlem baÅŸarÄ±sÄ±z: ${l.message||"Beklenmeyen hata"}`,"error")}finally{Z(!1)}}async function oe(){if(!(!X||!t.id)){Z(!0);try{const a=await Y.applyCurrentPriceToQuote(t.id);if(!a||a.success===!1)throw new Error(a?.error||"Fiyat gÃ¼ncellemesi baÅŸarÄ±sÄ±z");d?.("Fiyat baÅŸarÄ±yla gÃ¼ncellendi","success"),pe(!1),Se(null),typeof b=="function"&&await b(),E&&P&&await E(y)}catch(a){console.error("Price update error:",a),d?.(`Fiyat gÃ¼ncellemesi baÅŸarÄ±sÄ±z: ${a.message||"Beklenmeyen hata"}`,"error")}finally{Z(!1)}}}async function ue(a){const l=Array.from(a),s=[];for(const w of l){if(w.size/1048576>_e)continue;const me=Ie(w.name);if(!je.includes(me))continue;const ke=await Ye(w);s.push({name:w.name,type:w.type||me,size:w.size,dataUrl:ke})}L(w=>w.concat(s).slice(0,At))}async function xe(a){const l=Array.from(a),s=[];for(const w of l){if(w.size/1048576>_e)continue;const me=Ie(w.name);if(!Qe(me)&&!Qe(w.type))continue;const ke=await Ye(w);s.push({name:w.name,type:w.type||me,size:w.size,dataUrl:ke})}te(w=>w.concat(s).slice(0,Tt))}async function re(){if(u){const a={id:Ke(),createdAt:new Date().toISOString(),status:D,files:j,productImages:Q};k&&k.formStructure.fields&&k.formStructure.fields.forEach(l=>{let s=V[l.id];l.type==="multiselect"&&typeof s=="string"?s=s.split(",").map(w=>w.trim()).filter(Boolean):l.type==="number"&&(s=s&&(parseFloat(s)||s)),a[l.id]=s}),await Y.createQuote(a),d("Yeni kayÄ±t baÅŸarÄ±yla oluÅŸturuldu!","success")}else{const a={status:D,files:j,productImages:Q};k&&k.formStructure.fields&&k.formStructure.fields.forEach(l=>{let s=V[l.id];l.type==="multiselect"&&typeof s=="string"?s=s.split(",").map(w=>w.trim()).filter(Boolean):l.type==="number"&&(s=s&&(parseFloat(s)||s)),a[l.id]=s}),await Y.updateQuote(t.id,a),d("KayÄ±t baÅŸarÄ±yla gÃ¼ncellendi!","success")}z(!1);try{typeof b=="function"&&await b()}catch{}c()}const ge=he&&X&&e.createElement("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},onClick:()=>pe(!1)},e.createElement("div",{className:"card detail-modal",style:{width:"min(500px, 90vw)",maxHeight:"85vh",overflowY:"auto",position:"relative",padding:"20px",margin:"20px"},onClick:a=>a.stopPropagation()},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)"}},e.createElement("h3",{style:{margin:0}},"Fiyat GÃ¼ncelleme"),e.createElement("button",{style:{background:"none",border:"none",color:"#888",fontSize:"24px",cursor:"pointer",padding:0,width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>pe(!1)},"Ã—")),e.createElement("div",{style:{marginBottom:"20px"}},e.createElement("p",{style:{margin:"8px 0"}},`MÃ¼ÅŸteri: ${X.customerName}`),e.createElement("p",{style:{margin:"8px 0"}},`Proje: ${X.projectName}`),e.createElement("p",{style:{margin:"8px 0"}},`Mevcut Fiyat: â‚º${X.currentPrice.toFixed(2)}`),e.createElement("p",{style:{margin:"8px 0"}},`Yeni Fiyat: â‚º${X.newPrice.toFixed(2)}`),e.createElement("p",{style:{margin:"8px 0",color:X.priceDifference>=0?"#dc3545":"#28a745",fontWeight:"bold"}},`Fiyat FarkÄ±: ${X.priceDifference>=0?"+":""}â‚º${X.priceDifference.toFixed(2)}`),e.createElement("div",{style:{margin:"8px 0",fontSize:"13px",color:"#666"}},e.createElement("div",null,`Orijinal Versiyon: ${X.originalVersion}`),e.createElement("div",null,`Mevcut Versiyon: ${X.currentVersion}`),e.createElement("div",null,`GÃ¼ncel Versiyon: ${X.latestVersion}`),e.createElement("div",null,`KarÅŸÄ±laÅŸtÄ±rma BazÄ±: ${X.comparisonBasis}`)),X.parameterChanges&&X.parameterChanges.length>0&&e.createElement("div",{style:{margin:"12px 0"}},e.createElement("strong",{style:{display:"block",marginBottom:"6px"}},"Parametre DeÄŸiÅŸiklikleri"),e.createElement("ul",{style:{paddingLeft:"18px",margin:0}},X.parameterChanges.map((a,l)=>e.createElement("li",{key:l,style:{marginBottom:"4px",color:"#555"}},a))))),e.createElement("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"15px"}},e.createElement("button",{className:"btn btn-secondary",onClick:()=>pe(!1)},"Ä°ptal"),e.createElement("button",{className:"btn btn-primary",onClick:oe,disabled:q},q?"GÃ¼ncelleniyor...":"FiyatÄ± GÃ¼ncelle"))));return e.createElement("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.6)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},onClick:c},e.createElement("div",{className:"card detail-modal",style:{width:"min(680px, 96vw)",maxHeight:"85vh",overflowY:"auto",position:"relative",padding:12,fontSize:13},onClick:a=>a.stopPropagation()},e.createElement("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",marginBottom:6,position:"sticky",top:0,zIndex:5,background:"linear-gradient(180deg, #0f1e2c, #0c1924)",padding:"8px 6px",borderBottom:"1px solid rgba(255,255,255,0.08)"}},e.createElement("h3",{style:{margin:0,fontSize:16}},o.a_detail),e.createElement("div",{className:"row",style:{alignItems:"center",gap:"8px"}},!h&&!u?e.createElement("button",{className:"btn",onClick:()=>z(!0),onMouseOver:a=>a.target.style.backgroundColor="rgba(0,0,0,0.1)",onMouseOut:a=>a.target.style.backgroundColor="",style:{transition:"all 0.2s ease"}},o.edit):e.createElement(e.Fragment,null,e.createElement("button",{className:"btn accent",onClick:re,onMouseOver:a=>a.target.style.backgroundColor="rgba(255,255,255,0.2)",onMouseOut:a=>a.target.style.backgroundColor="",style:{transition:"all 0.2s ease"}},o.save),e.createElement("button",{className:"btn",onClick:()=>z(!1),onMouseOver:a=>a.target.style.backgroundColor="rgba(0,0,0,0.1)",onMouseOut:a=>a.target.style.backgroundColor="",style:{transition:"all 0.2s ease"}},o.cancel)),!h&&t.priceStatus&&e.createElement("span",{onClick:a=>{a.stopPropagation(),_()},title:"Fiyat gÃ¼ncelleme bilgileri iÃ§in tÄ±klayÄ±n",style:{display:"inline-flex",alignItems:"center",gap:"4px",padding:"2px 6px",borderRadius:"4px",fontSize:"10px",fontWeight:"500",border:"1px solid rgba(239, 68, 68, 0.3)",cursor:"pointer",opacity:1,transition:"0.2s",backgroundColor:"rgba(239, 68, 68, 0.1)",color:"#ef4444"}},e.createElement("span",null,"â“"),e.createElement("span",null,t.priceStatus?.status==="drift"?"Sapma":t.priceStatus?.status==="outdated"?"GÃ¼ncel DeÄŸil":t.priceStatus?.status==="unknown"?"Bilinmeyen":"Durum")),e.createElement("button",{className:"btn",onClick:c,title:o.tt_close,onMouseOver:a=>a.target.style.backgroundColor="rgba(0,0,0,0.1)",onMouseOut:a=>a.target.style.backgroundColor="",style:{transition:"all 0.2s ease"}},"Ã—"))),!u&&e.createElement("div",{className:"card manual-price-management",style:{padding:"12px",marginBottom:"12px",background:"rgba(15, 30, 44, 0.65)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:"8px"}},e.createElement("div",{className:"manual-price-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"}},e.createElement("strong",null,"Manuel Fiyat YÃ¶netimi"),m&&e.createElement("span",{className:"manual-price-lock-indicator",style:{color:"#ffc107",fontSize:"12px",fontWeight:600}},`###ðŸ”’ ${p(ie?.price??t.price)}`)),e.createElement("div",{className:"manual-price-controls",style:{display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center",marginBottom:"6px"}},e.createElement("input",{type:"number",step:"0.01",min:"0",value:be,onChange:a=>ae(a.target.value),disabled:q,className:"manual-price-input",style:{flex:"0 0 140px",padding:"6px 8px",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(15,23,42,0.45)",color:"var(--text, #f8fafc)"}}),e.createElement("input",{type:"text",placeholder:"Not (opsiyonel)",value:ne,onChange:a=>ce(a.target.value),disabled:q,className:"manual-price-note",style:{flex:"1 1 200px",minWidth:"160px",padding:"6px 8px",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(15,23,42,0.45)",color:"var(--text, #f8fafc)"}}),e.createElement("button",{className:"btn manual-price-btn",onClick:C,disabled:q,style:{padding:"4px 8px",fontSize:"12px",opacity:q?.6:1}},m?"GÃ¼ncelle":"Kilitle"),m&&e.createElement("button",{onClick:()=>{console.log("ðŸ”´ UYGULA BUTTON CLICKED!"),console.log("ðŸ”´ manualLoading:",q),console.log("ðŸ”´ item.id:",t?.id),I(!0)},disabled:q,className:"manual-price-apply-btn",style:{marginLeft:"4px",padding:"2px 4px",border:"1px solid rgba(220, 53, 69, 0.6)",borderRadius:"4px",backgroundColor:"rgb(220, 53, 69)",color:"#fff",fontSize:"10px",cursor:q?"not-allowed":"pointer",opacity:q?.7:1}},"Uygula"),m&&e.createElement("button",{className:"btn manual-price-btn",onClick:()=>I(!1),disabled:q,style:{padding:"4px 8px",fontSize:"12px",opacity:q?.6:1}},"Kilidi AÃ§")),e.createElement("div",{className:"manual-price-description",style:{fontSize:"12px",color:"rgba(255,255,255,0.75)",lineHeight:1.5}},m?[T?`Kilit ${T} tarihinde ${i||"admin"} tarafÄ±ndan oluÅŸturuldu.`:`Kilit ${i||"admin"} tarafÄ±ndan oluÅŸturuldu.`,ie?.note?` Not: ${ie.note}`:null].filter(Boolean).join(" "):"Bu alanÄ± kullanarak otomatik fiyatÄ± geÃ§ersiz kÄ±lÄ±p manuel deÄŸer belirleyebilirsiniz."),q&&e.createElement("div",{className:"manual-price-loading",style:{fontSize:"11px",color:"#9ca3af",marginTop:"4px"}},"Ä°ÅŸlem yapÄ±lÄ±yor...")),!h&&!u?e.createElement("div",{className:"grid two",style:{gap:8}},...ve()):e.createElement("div",{className:"grid two",style:{gap:8}},...Ne()),e.createElement("div",{style:{height:10}}),e.createElement("div",{className:"row wrap"},e.createElement("button",{className:D==="review"?"btn accent":"btn",onClick:()=>{f("review"),n(t.id,"review")},style:{padding:"6px 10px",fontSize:12},title:o.tt_status_review},o.s_review),e.createElement("button",{className:D==="feasible"?"btn accent":"btn",onClick:()=>{f("feasible"),n(t.id,"feasible")},style:{padding:"6px 10px",fontSize:12},title:o.tt_status_feasible},o.s_feasible),e.createElement("button",{className:D==="not"?"btn accent":"btn",onClick:()=>{f("not"),n(t.id,"not")},style:{padding:"6px 10px",fontSize:12},title:o.tt_status_not},o.s_not),e.createElement("button",{className:D==="quoted"?"btn accent":"btn",onClick:()=>{f("quoted"),n(t.id,"quoted")},style:{padding:"6px 10px",fontSize:12},title:o.tt_status_quoted},o.s_quoted),e.createElement("button",{className:D==="approved"?"btn accent":"btn",onClick:()=>{f("approved"),n(t.id,"approved")},style:{padding:"6px 10px",fontSize:12}},o.s_approved)),e.createElement("div",{style:{height:10}}),h?e.createElement("div",{className:"grid two",style:{gap:8,marginBottom:6}},e.createElement("div",{className:"card",style:{padding:10}},e.createElement("div",{className:"help",style:{marginBottom:6}},o.add_tech_file),e.createElement("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg,.dxf,.dwg,.step,.stp,.iges,.igs,application/pdf,image/png,image/jpeg,image/jpg",onChange:a=>ue(a.target.files)})),e.createElement("div",{className:"card",style:{padding:10}},e.createElement("div",{className:"help",style:{marginBottom:6}},o.add_prod_image),e.createElement("input",{type:"file",multiple:!0,accept:".png,.jpg,.jpeg,image/png,image/jpeg,image/jpg",onChange:a=>xe(a.target.files)}))):null,(j||[]).length?e.createElement("div",{className:"grid two",style:{gap:8}},j.map((a,l)=>e.createElement("div",{key:l,className:"card file-card",style:{padding:10,position:"relative"}},e.createElement("div",{style:{marginBottom:6}},`${a.name} (${(a.size/1024).toFixed(0)} KB)`),(a.type||"").toLowerCase().includes("image")||["png","jpg","jpeg"].includes((a.type||"").toLowerCase())?e.createElement("img",{className:"preview-img",src:(function(){const s=a.dataUrl||""||a.url||"";return/^https?:/i.test(s)?s:s?Re.replace(/\/$/,"")+s:""})(),alt:a.name}):e.createElement("div",{className:"file-thumb"},"Preview not available"),h?e.createElement("div",{className:"dl-group"},e.createElement("button",{className:"btn icon-btn",title:o.tt_download_txt,onClick:()=>{a.dataUrl?Be(a.name,a.dataUrl):window.open(a.url,"_blank")}},"â¬‡"),e.createElement("button",{className:"btn icon-btn danger",title:o.a_delete,onClick:()=>L(s=>s.filter((w,H)=>H!==l))},"ðŸ—‘ï¸")):e.createElement("button",{className:"btn icon-btn dl-center",title:o.tt_download_txt,onClick:()=>{if(a.dataUrl)Be(a.name,a.dataUrl);else{const s=a.url||"";window.open(/^https?:/i.test(s)?s:Re.replace(/\/$/,"")+s,"_blank")}}},"â¬‡")))):null,(Q||[]).length?e.createElement("div",{className:"grid two",style:{gap:8,marginTop:10}},Q.map((a,l)=>e.createElement("div",{key:l,className:"card file-card",style:{padding:10,position:"relative"}},e.createElement("div",{style:{marginBottom:6}},`${a.name} (${(a.size/1024).toFixed(0)} KB)`),(a.type||"").toLowerCase().includes("image")||["png","jpg","jpeg"].includes((a.type||"").toLowerCase())?e.createElement("img",{className:"preview-img",src:(function(){const s=a.dataUrl||""||a.url||"";return/^https?:/i.test(s)?s:s?Re.replace(/\/$/,"")+s:""})(),alt:a.name}):e.createElement("div",{className:"file-thumb"},"Preview not available"),h?e.createElement("div",{className:"dl-group"},e.createElement("button",{className:"btn icon-btn",title:o.tt_download_txt,onClick:()=>{a.dataUrl?Be(a.name,a.dataUrl):window.open(a.url,"_blank")}},"â¬‡"),e.createElement("button",{className:"btn icon-btn danger",title:o.a_delete,onClick:()=>te(s=>s.filter((w,H)=>H!==l))},"ðŸ—‘ï¸")):e.createElement("button",{className:"btn icon-btn dl-center",title:o.tt_download_txt,onClick:()=>{if(a.dataUrl)Be(a.name,a.dataUrl);else{const s=a.url||"";window.open(/^https?:/i.test(s)?s:Re.replace(/\/$/,"")+s,"_blank")}}},"â¬‡")))):null),ge);function de(a,l){return e.createElement("div",{className:"card",style:{padding:10,fontSize:13}},e.createElement("div",{className:"help",style:{fontSize:11}},a),e.createElement("div",null,String(l||"â€”")))}function B(a,l){return e.createElement("div",{className:"card",style:{padding:10}},e.createElement("div",{className:"help",style:{fontSize:11}},a),e.createElement("input",{value:V[l]??"",onChange:s=>Ee(l,s.target.value)}))}function N(a,l){return e.createElement("div",{className:"card",style:{padding:10}},e.createElement("div",{className:"help",style:{fontSize:11}},a),e.createElement("textarea",{value:V[l]??"",onChange:s=>Ee(l,s.target.value)}))}function R(a,l,s=["yes","no"]){return e.createElement("div",{className:"card",style:{padding:10}},e.createElement("div",{className:"help",style:{fontSize:11,marginBottom:6}},a),e.createElement("div",{className:"row"},s.map(w=>e.createElement("label",{key:w,className:"chip"},e.createElement("input",{type:"radio",name:l,checked:(V[l]||"")===w,onChange:()=>Ee(l,w)}),e.createElement("span",null,w==="yes"?o.yes||"Evet":w==="no"?o.no||"HayÄ±r":w)))))}}const{useState:Qt,useEffect:Ht}=e;function Xt({onClose:t,onSettingsUpdated:c,t:n,showNotification:b,globalProcessing:o,setGlobalProcessing:u,checkAndProcessVersionUpdates:d,initialTab:k="pricing"}){const[x,P]=Qt(k);Ht(()=>(document.body.classList.add("modal-open"),()=>{document.body.classList.remove("modal-open")}),[]);function E(){c(),t()}return e.createElement("div",{className:"modal-overlay",onClick:E},e.createElement("div",{className:"modal-content",onClick:y=>y.stopPropagation(),style:{maxWidth:"900px",width:"90vw",maxHeight:"90vh",overflow:"auto"}},e.createElement("div",{className:"modal-header"},e.createElement("h2",null,n.settings_title||"Ayarlar"),e.createElement("button",{onClick:E,className:"btn btn-close",style:{position:"absolute",top:"15px",right:"15px",background:"none",border:"none",fontSize:"24px",cursor:"pointer"}},"Ã—")),e.createElement("div",{className:"tab-navigation",style:{borderBottom:"1px solid #ddd",marginBottom:"20px"}},e.createElement("button",{className:`tab-button ${x==="pricing"?"active":""}`,onClick:()=>P("pricing"),style:{padding:"10px 20px",border:"none",background:x==="pricing"?"#007bff":"transparent",color:x==="pricing"?"white":"#007bff",cursor:"pointer",borderRadius:"4px 4px 0 0"}},"FiyatlandÄ±rma"),e.createElement("button",{className:`tab-button ${x==="form"?"active":""}`,onClick:()=>P("form"),style:{padding:"10px 20px",border:"none",background:x==="form"?"#007bff":"transparent",color:x==="form"?"white":"#007bff",cursor:"pointer",borderRadius:"4px 4px 0 0",marginLeft:"5px"}},"Form YapÄ±sÄ±"),e.createElement("button",{className:`tab-button ${x==="users"?"active":""}`,onClick:()=>P("users"),style:{padding:"10px 20px",border:"none",background:x==="users"?"#007bff":"transparent",color:x==="users"?"white":"#007bff",cursor:"pointer",borderRadius:"4px 4px 0 0",marginLeft:"5px"}},"KullanÄ±cÄ±lar")),e.createElement("div",{className:"tab-content"},x==="pricing"&&e.createElement(wt,{t:n,showNotification:b,globalProcessing:o,setGlobalProcessing:u,checkAndProcessVersionUpdates:d}),x==="form"&&e.createElement(St,{t:n,showNotification:b}),x==="users"&&e.createElement(Nt,{t:n,showNotification:b})),e.createElement("div",{className:"modal-footer",style:{marginTop:"20px",textAlign:"right"}},e.createElement("button",{onClick:E,className:"btn btn-secondary"},n.close||"Kapat"))))}function Zt({filters:t,filterOptions:c,onFilterChange:n,onClose:b,t:o,formConfig:u}){const[d,k]=e.useState("status");function x(h,z){const V={status:"Durum",dateRange:"Tarih AralÄ±ÄŸÄ±",qtyRange:"Miktar AralÄ±ÄŸÄ±"};return u&&u.formStructure&&u.formStructure.fields&&u.formStructure.fields.forEach(O=>{O.display&&O.display.showInFilter&&(V[O.id]=O.label||O.id)}),V[h]||h}function P(){const h=["status"];return u&&u.formStructure&&u.formStructure.fields&&u.formStructure.fields.forEach(z=>{z.display&&z.display.showInFilter&&h.push(z.id)}),h}function E(h,z,V){V?n(h,z,"add"):n(h,z,"remove")}function y(h,z,V){const j={...t[h]||{},[z]:V};n(h,j,"set")}function D(h){h==="dateRange"?n(h,{from:"",to:""},"set"):h==="qtyRange"?n(h,{min:"",max:""},"set"):n(h,[],"set")}function f(){const h=d;if(h==="status"){const j=c[h]||[],L=t[h]||[];return j.length===0?e.createElement("p",{style:{color:"#666",fontStyle:"italic"}},"Bu kategori iÃ§in filtre seÃ§eneÄŸi bulunmuyor."):e.createElement("div",null,e.createElement("div",{style:{marginBottom:"15px"}},e.createElement("button",{onClick:()=>{L.length===j.length?n(h,[],"set"):n(h,j,"set")},style:{padding:"6px 12px",backgroundColor:L.length===j.length?"#dc3545":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"}},L.length===j.length?"TÃ¼mÃ¼nÃ¼ KaldÄ±r":"TÃ¼mÃ¼nÃ¼ SeÃ§")),e.createElement("div",{style:{maxHeight:"300px",overflowY:"auto"}},j.map(Q=>e.createElement("label",{key:Q,style:{display:"flex",alignItems:"center",padding:"8px 0",cursor:"pointer",borderBottom:"1px solid #f0f0f0"}},e.createElement("input",{type:"checkbox",checked:L.includes(Q),onChange:te=>E(h,Q,te.target.checked),style:{marginRight:"10px"}}),e.createElement("span",null,Q||"BelirtilmemiÅŸ")))))}let z=null;if(u&&u.formStructure&&u.formStructure.fields&&(z=u.formStructure.fields.find(j=>j.id===h)),!z)return e.createElement("p",{style:{color:"#666",fontStyle:"italic"}},"Bu kategori iÃ§in yapÄ±landÄ±rma bulunamadÄ±.");if(z.type==="date"){const j=t[h]||{from:"",to:""};return e.createElement("div",null,e.createElement("div",{style:{marginBottom:"15px"}},e.createElement("label",{style:{display:"block",marginBottom:"5px"}},"BaÅŸlangÄ±Ã§ Tarihi:"),e.createElement("input",{type:"date",value:j.from||"",onChange:L=>y(h,"from",L.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})),e.createElement("div",{style:{marginBottom:"15px"}},e.createElement("label",{style:{display:"block",marginBottom:"5px"}},"BitiÅŸ Tarihi:"),e.createElement("input",{type:"date",value:j.to||"",onChange:L=>y(h,"to",L.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})))}if(z.type==="number"){const j=t[h]||{min:"",max:""},L=z.label||z.id;return e.createElement("div",null,e.createElement("div",{style:{marginBottom:"15px"}},e.createElement("label",{style:{display:"block",marginBottom:"5px"}},`Minimum ${L}:`),e.createElement("input",{type:"number",value:j.min||"",onChange:Q=>y(h,"min",Q.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})),e.createElement("div",{style:{marginBottom:"15px"}},e.createElement("label",{style:{display:"block",marginBottom:"5px"}},`Maksimum ${L}:`),e.createElement("input",{type:"number",value:j.max||"",onChange:Q=>y(h,"max",Q.target.value),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"}})))}const V=c[h]||[],O=t[h]||[];return V.length===0?e.createElement("p",{style:{color:"#666",fontStyle:"italic"}},"Bu kategori iÃ§in filtre seÃ§eneÄŸi bulunmuyor."):e.createElement("div",null,e.createElement("div",{style:{marginBottom:"15px"}},e.createElement("button",{onClick:()=>{O.length===V.length?n(h,[],"set"):n(h,V,"set")},style:{padding:"6px 12px",backgroundColor:O.length===V.length?"#dc3545":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"}},O.length===V.length?"TÃ¼mÃ¼nÃ¼ KaldÄ±r":"TÃ¼mÃ¼nÃ¼ SeÃ§")),e.createElement("div",{style:{maxHeight:"300px",overflowY:"auto"}},V.map(j=>e.createElement("label",{key:j,style:{display:"flex",alignItems:"center",padding:"8px 0",cursor:"pointer",borderBottom:"1px solid #f0f0f0"}},e.createElement("input",{type:"checkbox",checked:O.includes(j),onChange:L=>E(h,j,L.target.checked),style:{marginRight:"10px"}}),e.createElement("span",null,j||"BelirtilmemiÅŸ")))))}return e.createElement("div",{className:"modal-overlay",onClick:b,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3}},e.createElement("div",{className:"modal-content",onClick:h=>h.stopPropagation(),style:{backgroundColor:"white",borderRadius:"8px",padding:"20px",maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"hidden",display:"flex",flexDirection:"column"}},e.createElement("h3",{style:{margin:"0 0 20px 0"}},"ðŸ” Filtreler"),e.createElement("div",{style:{display:"flex",borderBottom:"1px solid #ddd",marginBottom:"20px",flexWrap:"wrap",gap:"2px"}},P().map(h=>e.createElement("button",{key:h,onClick:()=>k(h),style:{padding:"8px 12px",border:"none",background:d===h?"#007bff":"#f8f9fa",color:d===h?"white":"#333",cursor:"pointer",borderRadius:"4px 4px 0 0",fontSize:"12px",transition:"all 0.2s ease"}},x(h)))),e.createElement("div",{style:{flex:1,overflowY:"auto",marginBottom:"20px"}},f()),e.createElement("div",{style:{display:"flex",justifyContent:"space-between",gap:"10px",borderTop:"1px solid #ddd",paddingTop:"15px"}},e.createElement("button",{onClick:()=>D(d),style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},x(d)+" Temizle"),e.createElement("button",{onClick:b,style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},"Kapat"))))}const{useState:K,useEffect:He,useMemo:qe,useRef:Jt}=e,ea=["price-drift","content-drift","outdated","unknown","error"];function ot(t){return t?!!(ea.includes(t.priceStatus?.status)||t.needsPriceUpdate===!0||t.formStructureChanged):!1}function ta({t,onLogout:c,showNotification:w}){const[b,o]=K([]),[u,d]=K(null),[k,x]=K(!1),[P,E]=K(new Set),[y,D]=K(!1),[f,h]=K(null),[z,V]=K("count"),[O,j]=K(!1),[L,Q]=K(""),[te,ie]=K(null),[se,be]=K({}),[ae,ne]=K(!1),[ce,q]=K(null),[Z,he]=K({currentPage:1,itemsPerPage:10,totalItems:0}),[pe,X]=K("quotes"),[Se,Ee]=K([]),[Ne,ve]=K(!1),[m,T]=K({email:"",password:"",role:"admin"}),[i,g]=K({status:[],dateRange:{from:"",to:""},qtyRange:{min:"",max:""}}),[S,p]=K(!0),[C,_]=K(null),[I,oe]=K(null),[ue,xe]=K(!1),[re,ge]=K(""),de=Jt(!1),[B,N]=K({columnId:"date",direction:"desc"});He(()=>{R()},[]);async function R(){p(!0),_(null);try{console.log("ðŸ”§ Admin: Loading quotes from API...");const r=await Y.listQuotes();console.log("ðŸ”§ Admin: Loaded",r.length,"quotes"),o(r),await a(r),p(!1),_(null)}catch(r){console.error("API quotes loading error:",r),r.message.includes("401")||r.message.includes("unauthorized")?(_("Oturum sÃ¼reniz dolmuÅŸ. LÃ¼tfen tekrar giriÅŸ yapÄ±n."),c()):_(`Veri yÃ¼kleme hatasÄ±: ${r.message}`),p(!1)}}async function a(r){try{let v=r;if((!v||!Array.isArray(v))&&(v=b||[],v.length===0)){console.log("ðŸ”§ No quotes data available for version update check");return}const F=v.filter(A=>!A.manualOverride?.active&&(A.priceStatus?.status==="outdated"||A.priceStatus?.status==="drift"||A.priceStatus?.status==="unknown"||!A.priceStatus));if(F.length>0){xe(!0),ge(`DeÄŸiÅŸiklikler uygulanÄ±yor... (${F.length} teklif)`);const A=5;for(let W=0;W<F.length;W+=A){const G=F.slice(W,W+A);ge(`DeÄŸiÅŸiklikler uygulanÄ±yor... (${W+G.length}/${F.length})`),await Promise.all(G.map(async U=>{try{const M=await Y.compareQuotePriceVersions(U.id);if(M.needsUpdate){const $={...U,priceStatus:M.status};o(le=>le.map(we=>we.id===U.id?$:we))}}catch(M){console.warn(`Failed to update quote ${U.id}:`,M)}})),await new Promise(U=>setTimeout(U,200))}xe(!1),ge("")}}catch(v){console.error("Version update check failed:",v),xe(!1),ge("")}}He(()=>{me(),ke(),pe==="users"&&H()},[pe]);async function l(){console.log("ðŸ”§ DEBUG: refresh() called");try{console.log("ðŸ”„ Syncing localStorage quotes to Firebase...");const r=await Y.syncLocalQuotesToFirebase();r.synced>0&&(console.log("âœ… Synced",r.synced,"localStorage quotes to Firebase"),w(`Synced ${r.synced} local quotes to database`,"success")),await R(),await me(),await ke(),pe==="users"&&await H(),console.log("ðŸ”§ DEBUG: refresh() completed successfully")}catch(r){console.error("ðŸ”§ DEBUG: refresh() error:",r),w("Refresh failed: "+r.message,"error")}}e.useEffect(()=>{if(u&&u.id&&b&&b.length>0){const r=b.find(v=>v.id===u.id);r&&JSON.stringify(r)!==JSON.stringify(u)&&(console.log("ðŸ”§ Updating detail modal with refreshed data from list change"),d(r))}},[b,u]);async function s(r){console.log("ðŸ”§ DEBUG: handleAddRecord called with:",r);try{console.log("ðŸ”§ DEBUG: Calling API.addQuote...");const v=await Y.addQuote(r);console.log("ðŸ”§ DEBUG: API.addQuote result:",v),console.log("ðŸ”§ DEBUG: Refreshing list..."),await l(),console.log("ðŸ”§ DEBUG: Showing success notification..."),w("KayÄ±t baÅŸarÄ±yla eklendi","success"),console.log("ðŸ”§ DEBUG: Add record completed successfully")}catch(v){console.error("ðŸ”§ DEBUG: Error adding record:",v),w("KayÄ±t eklenirken hata oluÅŸtu: "+v.message,"error")}}function w(r,v="info"){q({message:r,type:v}),setTimeout(()=>{q(null)},3e3)}async function H(){try{const r=await Y.listUsers();Ee(r)}catch(r){console.error("Users load error:",r),w("KullanÄ±cÄ±lar yÃ¼klenemedi","error")}}async function me(){try{if(typeof Y.getPriceSettings!="function"){console.warn("API.getPriceSettings is not available, using defaults"),be({currency:"USD",margin:20,discountThreshold:1e3,discountPercent:5});return}const r=await Y.getPriceSettings();be(r)}catch(r){console.error("Price settings load error:",r),be({currency:"USD",margin:20,discountThreshold:1e3,discountPercent:5})}}async function ke(){try{const r=await Y.getFormConfig();ie(r.formConfig)}catch(r){console.error("Form config load error:",r)}}const De=qe(()=>new Intl.Collator("tr",{sensitivity:"base",numeric:!0}),[]),ye=Vt(b,i,L,te),Fe=qe(()=>_t(te),[te]),Xe=qe(()=>{if(!Array.isArray(ye)||ye.length===0)return ye;const{columnId:r,direction:v}=B||{};if(!r)return ye;const F=Fe.find(G=>G.id===r),A=G=>{const U=rt(G,r);if(U==null)return null;if(F?.type==="date"){const M=Date.parse(U)||Date.parse(G?.createdAt)||0;return Number.isNaN(M)?0:M}if(F?.type==="currency"||F?.type==="number"){if(typeof U=="number")return U;const M=String(U).replace(/[^0-9,.-]/g,""),$=M.includes(",")?M.replace(/\./g,"").replace(",","."):M,le=parseFloat($);return Number.isNaN(le)?0:le}return typeof U=="number"?U:typeof U=="string"?U.toLowerCase():String(U)};return[...ye].sort((G,U)=>{const M=A(G),$=A(U);if(M===$)return 0;if(M==null)return v==="asc"?1:-1;if($==null)return v==="asc"?-1:1;if(typeof M=="number"&&typeof $=="number")return v==="asc"?M-$:$-M;const le=De.compare(String(M),String($));return v==="asc"?le:-le})},[ye,B,Fe,De]),dt=Ut(b,te),Ae=Xe.length,Te=Math.ceil(Ae/Z.itemsPerPage),Ze=(Z.currentPage-1)*Z.itemsPerPage,mt=Ze+Z.itemsPerPage,pt=Xe.slice(Ze,mt);e.useEffect(()=>{he(r=>({...r,totalItems:Ae}))},[Ae]);const Me=lt(b,z);lt(ye,z);function Oe(){return z==="value"?"Toplam DeÄŸer (â‚º)":"Adet"}async function Je(r,v){await Y.updateStatus(r,v),l(),w("KayÄ±t durumu gÃ¼ncellendi!","success")}async function ft(r){await Y.remove(r),l()}function gt(r,v){E(F=>{const A=new Set(F);return v?A.add(r):A.delete(r),A})}function yt(r){E(r?new Set(ye.map(v=>v.id)):new Set)}function bt(r){N(v=>{if(v?.columnId===r){const F=v.direction==="asc"?"desc":"asc";return{columnId:r,direction:F}}return{columnId:r,direction:r==="date"?"desc":"asc"}}),he(v=>({...v,currentPage:1}))}function ht(r){r==="cancel"?oe(v=>!v||v.finished||v.cancelling?v:(de.current=!0,{...v,cancelling:!0})):r==="close"&&(de.current=!1,oe(null))}async function xt(r,v="selected"){if(!Array.isArray(r)||r.length===0||I&&!I.finished&&!I.cancelled)return;const F=r.length;de.current=!1;const A=new Map(b.map($=>[$.id,$]));oe({active:!0,total:F,completed:0,currentIndex:0,currentId:null,currentName:"",cancelling:!1,finished:!1,cancelled:!1,errors:[],mode:v});let W=0,G=0;const U=[];for(let $=0;$<F&&!de.current;$++){const le=r[$],we=A.get(le);oe(fe=>fe&&{...fe,currentIndex:$,currentId:le,currentName:we?.name||le,completed:W});try{const fe=await Y.applyCurrentPriceToQuote(le);if(G+=1,fe?.quote){const et=fe.quote;o(Pe=>Pe.map(Le=>Le.id===le?{...Le,...et}:Le)),u&&u.id===le&&d(Pe=>Pe&&{...Pe,...et})}}catch(fe){console.error("Bulk update quote error:",le,fe),U.push({id:le,error:fe?.message||"Hata"})}W+=1,oe(fe=>fe&&{...fe,completed:W})}const M=de.current;de.current=!1,oe($=>$&&{...$,completed:W,currentId:null,currentName:"",finished:!0,active:!1,cancelling:!1,cancelled:M,errors:U}),v==="selected"&&E(new Set),M?w(`Toplu gÃ¼ncelleme iptal edildi (${W}/${F})`,U.length?"warning":"info"):U.length>0?w(`${G} kayÄ±t gÃ¼ncellendi, ${U.length} hata oluÅŸtu`,"warning"):w(`${G} fiyat gÃ¼ncellendi`,"success");try{await l(),!M&&G>0&&setTimeout(()=>{a()},100)}catch($){console.error("Bulk refresh error:",$)}}async function Et(r,v={}){if(!r)return;const F=v.originalPrice??(parseFloat(r.price)||0),A=v.newPrice??(parseFloat(r.priceStatus?.calculatedPrice)||F),W=v.differenceSummary??r.priceStatus?.differenceSummary??null,G=v.versions||{original:{version:r.priceCalculation?.version,versionId:r.priceCalculation?.versionId||r.priceVersion?.versionId||null,timestamp:r.priceCalculation?.timestamp||r.createdAt||null},applied:{version:r.priceVersionApplied?.versionNumber||r.priceVersion?.versionNumber||r.priceStatus?.settingsVersion||se?.version||null,versionId:r.priceVersionApplied?.versionId||r.priceVersion?.versionId||r.priceStatus?.settingsVersionId||se?.versionId||null,timestamp:r.priceVersionApplied?.capturedAt||r.priceVersion?.capturedAt||r.priceStatus?.lastApplied||null},latest:{version:se?.version||null,versionId:se?.versionId||null,timestamp:se?.updatedAt||null}},U=W?{...W,priceDiff:W.priceDiff??A-F,oldPrice:W.oldPrice??F,newPrice:W.newPrice??A}:null;h({item:r,originalPrice:F,newPrice:A,differenceSummary:U,versions:G,loading:!0});try{const M=await Y.getQuotePriceComparison(r.id),$=M.differenceSummary||{},le=$.oldPrice??M.quote.appliedPrice??F,we=$.newPrice??M.quote.latestPrice??A,fe={priceDiff:$.priceDiff??Number((we-le).toFixed(2)),oldPrice:le,newPrice:we,reasons:$.reasons||[],comparisonBaseline:$.comparisonBaseline||M.comparisonBaseline||"applied",parameterChanges:$.parameterChanges||{added:[],removed:[],modified:[]},formulaChanged:$.formulaChanged||!1,evaluatedAt:$.evaluatedAt||new Date().toISOString()};h({item:{...r,comparison:M},originalPrice:le,newPrice:we,differenceSummary:fe,versions:M.versions||G,loading:!1})}catch(M){console.error("Price comparison load error:",M),w("Fiyat karÅŸÄ±laÅŸtÄ±rmasÄ± yÃ¼klenemedi","error"),h($=>$?{...$,loading:!1,error:M.message}:null)}}async function vt(){if(f)try{console.log("ðŸ”§ Applying price update for quote:",f.item.id),h(F=>F&&{...F,updating:!0});const r=await Y.applyNewPrice(f.item.id);if(!r||r.success===!1)throw new Error(r?.error||"apply price failed");const v=r.quote||{...f.item,price:r.updatedPrice,calculatedPrice:r.calculatedPrice??r.updatedPrice,priceStatus:{...f.item.priceStatus||{},status:"current",differenceSummary:null}};o(F=>F.map(A=>A.id===f.item.id?{...A,...v}:A)),u&&u.id===f.item.id&&d(F=>({...F,...v})),w("Fiyat gÃ¼ncellendi!","success"),h(null),setTimeout(()=>{l()},100)}catch(r){console.error("Price review apply error:",r),w("Fiyat gÃ¼ncellenirken hata oluÅŸtu","error"),h(v=>v&&{...v,updating:!1})}}return e.createElement("div",{className:"admin-panel"},ce&&e.createElement("div",{style:{position:"fixed",top:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:ce.type==="success"?"#4caf50":ce.type==="error"?"#f44336":"#2196f3",color:"white",padding:"12px 24px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1e4,fontSize:"14px",fontWeight:"500",maxWidth:"400px",textAlign:"center",animation:"slideInDown 0.3s ease-out"}},ce.message),ue&&e.createElement("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(2px)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:2e4,fontSize:"16px",fontWeight:"500",color:"#333"}},e.createElement("div",{style:{width:"40px",height:"40px",border:"3px solid #f3f3f3",borderTop:"3px solid #2196f3",borderRadius:"50%",animation:"spin 1s linear infinite",marginBottom:"16px"}}),e.createElement("div",null,t.a_processing||"DeÄŸiÅŸiklikler uygulanÄ±yor...")),e.createElement("div",{className:"card",style:{marginBottom:12}},e.createElement("label",null,t.a_charts),e.createElement("div",{className:"row wrap",style:{gap:12,marginTop:6,display:"flex",flexWrap:"wrap",justifyContent:"space-between"}},e.createElement("div",{style:{flex:"1 1 calc(33.333% - 8px)",minWidth:250,maxWidth:"100%"}},e.createElement(We,{data:Me.byStatus,xLabel:t.dim_status,yLabel:Oe(),byKeyAlpha:!1})),e.createElement("div",{style:{flex:"1 1 calc(33.333% - 8px)",minWidth:250,maxWidth:"100%"}},e.createElement(We,{data:Me.byProcess,xLabel:t.dim_process,yLabel:Oe(),byKeyAlpha:!1})),e.createElement("div",{style:{flex:"1 1 calc(33.333% - 8px)",minWidth:250,maxWidth:"100%"}},e.createElement(We,{data:Me.byMaterial,xLabel:t.dim_material,yLabel:Oe(),byKeyAlpha:!1})))),e.createElement("div",{className:"card",style:{marginTop:16}},e.createElement("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"}},e.createElement("label",{style:{fontSize:"16px",fontWeight:"600",margin:0,minWidth:"120px"}},t.a_list),e.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"}},e.createElement("input",{type:"text",placeholder:"TÃ¼m veriler iÃ§inde arama...",value:L,onChange:r=>Q(r.target.value),style:{padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",minWidth:"200px"}}),e.createElement("button",{onClick:()=>j(!0),className:"btn",style:{backgroundColor:Ue(i)>0?"#28a745":"#6c757d",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",position:"relative"}},"ðŸ” Filtreler",Ue(i)>0&&e.createElement("span",{style:{position:"absolute",top:"-6px",right:"-6px",backgroundColor:"#dc3545",color:"white",borderRadius:"50%",width:"20px",height:"20px",fontSize:"11px",display:"flex",alignItems:"center",justifyContent:"center"}},Ue(i))),e.createElement("button",{onClick:()=>qt(g,Q),className:"btn",style:{backgroundColor:"#dc3545",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer"}},"Temizle"),e.createElement("button",{onClick:()=>{console.log("ðŸ”§ DEBUG: KayÄ±t Ekle button clicked"),ne(!0),console.log("ðŸ”§ DEBUG: showAddModal set to true")},className:"btn",style:{backgroundColor:"#28a745",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer"}},"KayÄ±t Ekle"),(function(){const r=P.size,v=b.filter(ot).length;if(r===0&&v===0)return null;const F=r>0?"SeÃ§ilen kayÄ±tlarÄ±n fiyatlarÄ±nÄ± gÃ¼ncelle":"TÃ¼mÃ¼ gÃ¼ncelle",A=async()=>{if(I&&!I.finished&&!I.cancelled){w("Bir toplu iÅŸlem zaten yÃ¼rÃ¼tÃ¼lÃ¼yor","info");return}const W=r>0?Array.from(P):b.filter(ot).map(G=>G.id);if(!W.length){w("GÃ¼ncellenecek kayÄ±t bulunamadÄ±","info");return}xt(W,r>0?"selected":"all")};return e.createElement("button",{onClick:A,className:"btn",style:{backgroundColor:"#17a2b8",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer"}},F)})())),e.createElement("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"8px"}},i.status.length>0&&e.createElement("span",{style:{backgroundColor:"#007bff",color:"white",padding:"4px 8px",borderRadius:"16px",fontSize:"11px",position:"relative",cursor:"pointer",transition:"all 0.2s ease",paddingRight:"20px"},onMouseOver:r=>r.target.style.backgroundColor="#0056b3",onMouseOut:r=>r.target.style.backgroundColor="#007bff",title:"Durum filtresini kaldÄ±r"},`Durum: ${i.status.join(", ")}`,e.createElement("span",{style:{position:"absolute",right:"4px",top:"50%",transform:"translateY(-50%)",cursor:"pointer",fontWeight:"bold",fontSize:"12px"},onClick:r=>{r.stopPropagation(),Gt(g,"status")}},"Ã—"))),e.createElement("div",{style:{marginTop:"12px",fontSize:"14px",color:"#666"}},`${ye.length} kayÄ±t gÃ¶steriliyor${ye.length!==b.length?` (toplam ${b.length} kayÄ±ttan)`:""}`)),e.createElement("div",{className:"table-container",style:{marginTop:"16px",overflowX:"auto"}},e.createElement("table",{className:"table"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,e.createElement("input",{type:"checkbox",checked:P.size===ye.length&&ye.length>0,onChange:r=>yt(r.target.checked),onClick:r=>r.stopPropagation()})),...Fe.map(r=>{const v=B?.columnId===r.id,F=v?B.direction==="asc"?"â†‘":"â†“":"â†•";return e.createElement("th",{key:r.id,style:{whiteSpace:"nowrap"}},e.createElement("button",{type:"button",onClick:()=>bt(r.id),style:{display:"inline-flex",alignItems:"center",gap:"6px",background:"none",border:"none",cursor:"pointer",padding:0,font:"inherit",color:v?"#007bff":"inherit"}},r.label,e.createElement("span",{style:{fontSize:"12px",opacity:v?1:.6}},F)))}),e.createElement("th",null,"Ä°ÅŸlemler"))),e.createElement("tbody",null,pt.map(r=>e.createElement("tr",{key:r.id,onClick:()=>{console.log("ðŸ”§ DEBUG: Row clicked for item:",r.id,r),d(r)},style:{cursor:"pointer"}},e.createElement("td",null,e.createElement("input",{type:"checkbox",checked:P.has(r.id),onChange:v=>{v.stopPropagation(),gt(r.id,v.target.checked)},onClick:v=>v.stopPropagation()})),...Fe.map(v=>e.createElement("td",{key:v.id},It(rt(r,v.id),v,r,{getPriceChangeType:F=>Lt(F,se),openPriceReview:Et,calculatePrice:F=>ct(F,se),statusLabel:Ge,t}))),e.createElement("td",null,e.createElement("div",{style:{display:"flex",gap:"4px"}},e.createElement("button",{onClick:v=>{v.stopPropagation(),console.log("ðŸ”§ DEBUG: Detay button clicked for item:",r.id,r),d(r)},className:"btn btn-sm",style:{fontSize:"12px",padding:"2px 6px"}},"Detay"),e.createElement("button",{onClick:v=>{v.stopPropagation(),console.log("â„¹ï¸ TODO: Production transfer placeholder for item:",r.id)},className:"btn btn-sm",style:{fontSize:"12px",padding:"2px 6px",backgroundColor:"#28a745",color:"white",border:"none"},title:t.send_to_production_btn||"Ãœretim Paneline Aktar"},"ðŸ­"),e.createElement("button",{onClick:v=>{v.stopPropagation(),ft(r.id)},className:"btn btn-sm btn-danger",style:{fontSize:"12px",padding:"2px 6px"}},"Sil")))))))),Te>1&&e.createElement("div",{className:"pagination-container",style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"10px",marginTop:"20px",padding:"20px 0"}},e.createElement("button",{onClick:()=>he(r=>({...r,currentPage:Math.max(1,r.currentPage-1)})),disabled:Z.currentPage===1,className:"btn btn-sm",style:{padding:"5px 10px"}},"â† Ã–nceki"),e.createElement("span",{style:{color:"var(--text)",fontSize:"14px",margin:"0 15px"}},`Sayfa ${Z.currentPage} / ${Te} (${Ae} kayÄ±t)`),e.createElement("button",{onClick:()=>he(r=>({...r,currentPage:Math.min(Te,r.currentPage+1)})),disabled:Z.currentPage===Te,className:"btn btn-sm",style:{padding:"5px 10px"}},"Sonraki â†’"),e.createElement("select",{value:Z.itemsPerPage,onChange:r=>he(v=>({...v,itemsPerPage:parseInt(r.target.value),currentPage:1})),style:{marginLeft:"20px",padding:"5px",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.2)",background:"rgba(255,255,255,0.1)",color:"var(--text)"}},e.createElement("option",{value:5},"5 kayÄ±t"),e.createElement("option",{value:10},"10 kayÄ±t"),e.createElement("option",{value:25},"25 kayÄ±t"),e.createElement("option",{value:50},"50 kayÄ±t"))),I&&e.createElement(na,{progress:I,onAction:ht}),y&&e.createElement(Xt,{onClose:()=>D(!1),onSettingsUpdated:l,t,showNotification:w,globalProcessing:ue,setGlobalProcessing:xe,checkAndProcessVersionUpdates:a}),u&&e.createElement(Yt,{item:u,onClose:()=>d(null),setItemStatus:Je,onSaved:l,formConfig:te,t,showNotification:w,globalProcessing:ue,setGlobalProcessing:xe,checkAndProcessVersionUpdates:a,currentQuotes:b}),O&&e.createElement(Zt,{filters:i,filterOptions:dt,formConfig:te,onFilterChange:(r,v,F)=>Wt(i,g,r,v,F),onClose:()=>j(!1),t}),f&&f.item&&e.createElement("div",{className:"modal-overlay",onClick:()=>h(null),style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3}},e.createElement("div",{className:"card detail-modal",onClick:r=>r.stopPropagation(),style:{width:"min(500px, 90vw)",maxHeight:"85vh",overflowY:"auto",position:"relative",padding:"20px",margin:"20px"}},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)"}},e.createElement("h3",{style:{margin:0}},"Fiyat GÃ¼ncelleme"),e.createElement("button",{onClick:()=>h(null),style:{background:"none",border:"none",color:"#888",fontSize:"24px",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center"}},"Ã—")),f.loading&&e.createElement("p",{style:{marginBottom:"12px",color:"#999"}},"KarÅŸÄ±laÅŸtÄ±rma yÃ¼kleniyor..."),f.error&&e.createElement("p",{style:{marginBottom:"12px",color:"#dc3545"}},`Hata: ${f.error}`),e.createElement("div",{style:{marginBottom:"20px"}},e.createElement("p",{style:{margin:"8px 0"}},`MÃ¼ÅŸteri: ${f.item.name||"N/A"}`),e.createElement("p",{style:{margin:"8px 0"}},`Proje: ${f.item.proj||"N/A"}`),e.createElement("p",{style:{margin:"8px 0"}},`Mevcut Fiyat: ${Number.isFinite(Number(f.originalPrice))?`â‚º${Number(f.originalPrice).toFixed(2)}`:"N/A"}`),e.createElement("p",{style:{margin:"8px 0"}},`Yeni Fiyat: ${Number.isFinite(Number(f.newPrice))?`â‚º${Number(f.newPrice).toFixed(2)}`:"N/A"}`),f.differenceSummary?.priceDiff!==void 0&&e.createElement("p",{style:{margin:"8px 0",color:"#dc3545",fontWeight:"bold"}},`Fiyat FarkÄ±: â‚º${Number(f.differenceSummary.priceDiff).toFixed(2)}`),f.versions&&e.createElement("div",{style:{margin:"8px 0",fontSize:"13px",color:"#666"}},e.createElement("div",null,`Orijinal Versiyon: ${f.versions.original?.version??"N/A"} (${f.versions.original?.versionId||"â€”"})`),e.createElement("div",null,`Mevcut Versiyon: ${f.versions.applied?.version??"N/A"} (${f.versions.applied?.versionId||"â€”"})`),e.createElement("div",null,`GÃ¼ncel Versiyon: ${f.versions.latest?.version??"N/A"} (${f.versions.latest?.versionId||"â€”"})`),f.differenceSummary?.comparisonBaseline&&e.createElement("div",null,`KarÅŸÄ±laÅŸtÄ±rma BazÄ±: ${f.differenceSummary.comparisonBaseline==="applied"?"Mevcut â†’ GÃ¼ncel":"Orijinal â†’ GÃ¼ncel"}`)),(()=>{const r=f.differenceSummary?.parameterChanges;if(!r)return null;const v=A=>A==null||A===""?"â€”":typeof A=="number"?A:String(A),F=[];return Array.isArray(r.added)&&r.added.forEach(A=>{const W=A?.name||A?.id||"Parametre",G=v(A?.newValue);F.push(`Yeni parametre: ${W}${G!=="â€”"?` = ${G}`:""}`)}),Array.isArray(r.removed)&&r.removed.forEach(A=>{const W=A?.name||A?.id||"Parametre",G=v(A?.oldValue);F.push(`Parametre kaldÄ±rÄ±ldÄ±: ${W}${G!=="â€”"?` (eski: ${G})`:""}`)}),Array.isArray(r.modified)&&r.modified.forEach(A=>{const W=A?.name||A?.id||"Parametre",G=v(A?.oldValue),U=v(A?.newValue);F.push(`${W}: ${G} â†’ ${U}`)}),F.length?e.createElement("div",{style:{margin:"12px 0"}},e.createElement("strong",{style:{display:"block",marginBottom:"6px"}},"Parametre DeÄŸiÅŸiklikleri"),e.createElement("ul",{style:{paddingLeft:"18px",margin:0}},...F.map((A,W)=>e.createElement("li",{key:W,style:{marginBottom:"4px",color:"#555"}},A)))):null})()),e.createElement("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end",borderTop:"1px solid rgba(255,255,255,0.1)",paddingTop:"15px"}},e.createElement("button",{onClick:()=>h(null),className:"btn btn-secondary"},"Ä°ptal"),e.createElement("button",{onClick:vt,className:"btn btn-primary",disabled:f.loading||f.updating},f.updating?"GÃ¼ncelleniyor...":"FiyatÄ± GÃ¼ncelle")))),e.createElement(aa,{isOpen:ae,onClose:()=>ne(!1),formConfig:te,onSave:s}))}function aa({isOpen:t,onClose:c,formConfig:n,onSave:b}){const[o,u]=K({}),[d,k]=K(!1);console.log("ðŸ”§ DEBUG: AddRecordModal render - isOpen:",t,"formConfig:",!!n),He(()=>{if(t&&n){const y={name:"",email:"",phone:"",company:"",proj:"",status:"new",createdAt:new Date().toISOString(),customFields:{}};n.formStructure&&n.formStructure.fields&&n.formStructure.fields.forEach(D=>{D.type==="multiselect"||D.type==="checkbox"?y.customFields[D.id]=[]:(D.type,y.customFields[D.id]="")}),u(y)}},[t,n]);function x(y,D,f){["name","email","phone","company","proj"].includes(y)?u(z=>({...z,[y]:D})):u(z=>({...z,customFields:{...z.customFields,[y]:f==="multiselect"&&typeof D=="string"?D.split(",").map(V=>V.trim()).filter(Boolean):D}}))}async function P(){if(!d){k(!0);try{const y={...o,createdAt:new Date().toISOString(),status:o.status||"new"};console.log("ðŸ”§ DEBUG: Submitting record data:",y),await b(y),console.log("ðŸ”§ DEBUG: Record saved successfully"),c(),u({})}catch(y){console.error("ðŸ”§ DEBUG: Error saving record:",y),alert("KayÄ±t kaydedilirken hata oluÅŸtu: "+y.message)}finally{k(!1)}}}function E(y){const D=o.customFields?.[y.id]||"";switch(y.type){case"textarea":return e.createElement("textarea",{value:D,onChange:f=>x(y.id,f.target.value,y.type),style:{width:"100%",minHeight:"80px",padding:"8px",border:"1px solid #ddd",borderRadius:"4px",resize:"vertical"},placeholder:y.label});case"radio":return e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},...(y.options||[]).map(f=>e.createElement("label",{key:f,style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer"}},e.createElement("input",{type:"radio",name:y.id,value:f,checked:D===f,onChange:h=>x(y.id,h.target.value,y.type)}),f)));case"multiselect":return e.createElement("input",{type:"text",value:Array.isArray(D)?D.join(", "):D,onChange:f=>x(y.id,f.target.value,y.type),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:`${y.label} (virgÃ¼lle ayÄ±rÄ±n)`});case"number":return e.createElement("input",{type:"number",value:D,onChange:f=>x(y.id,parseFloat(f.target.value)||0,y.type),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:y.label});case"date":return e.createElement("input",{type:"date",value:D,onChange:f=>x(y.id,f.target.value,y.type),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"}});case"email":return e.createElement("input",{type:"email",value:D,onChange:f=>x(y.id,f.target.value,y.type),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:y.label});default:return e.createElement("input",{type:"text",value:D,onChange:f=>x(y.id,f.target.value,y.type),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:y.label})}}return t?(console.log("ðŸ”§ DEBUG: AddRecordModal rendering modal content"),e.createElement("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:c},e.createElement("div",{className:"card detail-modal",style:{width:"min(600px, 90vw)",maxHeight:"85vh",overflowY:"auto",position:"relative",padding:"20px",margin:"20px"},onClick:y=>y.stopPropagation()},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",paddingBottom:"10px",borderBottom:"1px solid rgba(255,255,255,0.1)"}},e.createElement("h3",{style:{margin:0}},"Yeni KayÄ±t Ekle"),e.createElement("button",{onClick:c,className:"btn",style:{background:"none",border:"none",fontSize:"20px",cursor:"pointer",color:"#999"}},"Ã—")),e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"20px"}},e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},e.createElement("label",{style:{fontWeight:"bold",fontSize:"14px",color:"#333"}},"MÃ¼ÅŸteri AdÄ± *"),e.createElement("input",{type:"text",value:o.name||"",onChange:y=>x("name",y.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:"MÃ¼ÅŸteri adÄ±"})),e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},e.createElement("label",{style:{fontWeight:"bold",fontSize:"14px",color:"#333"}},"E-posta *"),e.createElement("input",{type:"email",value:o.email||"",onChange:y=>x("email",y.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:"E-posta adresi"})),e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},e.createElement("label",{style:{fontWeight:"bold",fontSize:"14px",color:"#333"}},"Telefon"),e.createElement("input",{type:"tel",value:o.phone||"",onChange:y=>x("phone",y.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:"Telefon numarasÄ±"})),e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},e.createElement("label",{style:{fontWeight:"bold",fontSize:"14px",color:"#333"}},"Åžirket"),e.createElement("input",{type:"text",value:o.company||"",onChange:y=>x("company",y.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:"Åžirket adÄ±"})),e.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},e.createElement("label",{style:{fontWeight:"bold",fontSize:"14px",color:"#333"}},"Proje"),e.createElement("input",{type:"text",value:o.proj||"",onChange:y=>x("proj",y.target.value),style:{width:"100%",padding:"8px",border:"1px solid #ddd",borderRadius:"4px"},placeholder:"Proje adÄ±"})),...n&&n.formStructure&&n.formStructure.fields?n.formStructure.fields.map(y=>e.createElement("div",{key:y.id,style:{display:"flex",flexDirection:"column",gap:"6px"}},e.createElement("label",{style:{fontWeight:"bold",fontSize:"14px",color:"#333"}},y.label+(y.required?" *":"")),E(y))):[]),e.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",marginTop:"20px",paddingTop:"20px",borderTop:"1px solid rgba(255,255,255,0.1)"}},e.createElement("button",{onClick:c,className:"btn",style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},"Ä°ptal"),e.createElement("button",{onClick:P,disabled:d,className:"btn",style:{padding:"10px 20px",backgroundColor:d?"#999":"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:d?"not-allowed":"pointer"}},d?"Kaydediliyor...":"Kaydet"))))):(console.log("ðŸ”§ DEBUG: AddRecordModal not rendering - isOpen is false"),null)}function na({progress:t,onAction:c}){const n=E=>Number.isFinite(E)?Math.max(0,Math.min(100,E)):0,b=t.total>0?n(t.completed/t.total*100):0,o=t.finished?t.cancelled?"Ä°ÅŸlem iptal edildi":"Toplu gÃ¼ncelleme tamamlandÄ±":t.cancelling?"Ä°ÅŸlem iptal ediliyor...":"Fiyatlar gÃ¼ncelleniyor...",u=!t.finished&&t.currentName?`Åžu an: ${t.currentName}`:"",d=!t.finished&&!t.cancelling,k=t.finished,x=Array.isArray(t.errors)?t.errors:[],P=x.slice(0,3);return e.createElement("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.65)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,pointerEvents:"auto"}},e.createElement("div",{style:{width:"min(420px, 90vw)",background:"#0f1e2c",color:"#fff",borderRadius:"12px",padding:"24px",position:"relative",boxShadow:"0 12px 32px rgba(0,0,0,0.35)"}},e.createElement("button",{onClick:()=>{t.finished?c("close"):t.cancelling||c("cancel")},style:{position:"absolute",top:"10px",right:"12px",background:"transparent",border:"none",color:"#aaa",fontSize:"20px",cursor:t.cancelling&&!t.finished?"default":"pointer"},disabled:t.cancelling&&!t.finished},"Ã—"),e.createElement("h3",{style:{margin:"0 0 12px 0",fontSize:"18px"}},"Toplu Fiyat GÃ¼ncelleme"),e.createElement("p",{style:{margin:"4px 0",fontSize:"14px",color:"#f1f1f1"}},o),u&&e.createElement("p",{style:{margin:"4px 0 12px 0",fontSize:"13px",color:"#b5b5b5"}},u),e.createElement("div",{style:{width:"100%",height:"12px",backgroundColor:"rgba(255,255,255,0.1)",borderRadius:"6px",overflow:"hidden"}},e.createElement("div",{style:{width:`${b}%`,height:"100%",background:t.finished?"#28a745":"#17a2b8",transition:"width 0.2s ease"}})),e.createElement("p",{style:{margin:"12px 0 0 0",fontSize:"13px",color:"#ddd"}},`Tamamlanan: ${t.completed}/${t.total}`),P.length>0&&e.createElement("div",{style:{marginTop:"12px",backgroundColor:"rgba(220,53,69,0.1)",padding:"12px",borderRadius:"8px",color:"#f5c6cb"}},e.createElement("strong",{style:{display:"block",marginBottom:"6px",color:"#f8d7da"}},"Hatalar"),e.createElement("ul",{style:{margin:0,paddingLeft:"18px",fontSize:"12px"}},...P.map((E,y)=>e.createElement("li",{key:`${E.id||y}-err`},typeof E=="string"?E:`${E.id?`${E.id}: `:""}${E.error||"Hata"}`))),x.length>P.length&&e.createElement("div",{style:{marginTop:"6px",fontSize:"12px"}},`+${x.length-P.length} diÄŸer hata`)),e.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"20px"}},d&&e.createElement("button",{onClick:()=>c("cancel"),className:"btn",style:{backgroundColor:"#ffc107",color:"#212529",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:t.cancelling?"not-allowed":"pointer",opacity:t.cancelling?.6:1},disabled:t.cancelling},"Ä°ptal Et"),k&&e.createElement("button",{onClick:()=>c("close"),className:"btn",style:{backgroundColor:"#28a745",color:"white",border:"none",padding:"6px 16px",borderRadius:"4px",cursor:"pointer"}},"Kapat"))))}function ra({message:t,type:c="success",onClose:n}){const b={position:"fixed",top:"20px",left:"50%",transform:"translateX(-50%)",backgroundColor:c==="success"?"#28a745":c==="error"?"#dc3545":c==="warning"?"#ffc107":"#17a2b8",color:c==="warning"?"#212529":"white",padding:"12px 20px",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",zIndex:9999,minWidth:"300px",maxWidth:"500px",display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"14px",fontWeight:"500",animation:"slideInDown 0.3s ease-out"};return e.createElement("div",{style:b},e.createElement("span",null,t),e.createElement("button",{onClick:n,style:{background:"none",border:"none",color:"inherit",fontSize:"16px",fontWeight:"bold",cursor:"pointer",marginLeft:"12px",padding:"0 4px",opacity:.8},onMouseOver:o=>o.target.style.opacity="1",onMouseOut:o=>o.target.style.opacity="0.8"},"Ã—"))}function la(){const[t,c]=e.useState([]);return{notifications:t,showNotification:(o,u="success",d=4e3)=>{const k=Date.now()+Math.random(),x={id:k,message:o,type:u};c(P=>[...P,x]),setTimeout(()=>{c(P=>P.filter(E=>E.id!==k))},d)},removeNotification:o=>{c(u=>u.filter(d=>d.id!==o))}}}const it=window.location.pathname.includes("quote-dashboard.html")?"admin":"quote";function oa(){const{t}=Pt(),[c,n]=ee.useState(!1),{notifications:b,showNotification:o,removeNotification:u}=la();ee.useEffect(()=>{async function P(){try{localStorage.getItem("bk_admin_token")&&(await Y.me(),n(!0))}catch{localStorage.removeItem("bk_admin_token"),n(!1)}}it==="admin"&&P()},[]);function d(){n(!0)}function k(){n(!1)}async function x(P){try{await Y.createQuote(P),o("Teklif baÅŸarÄ±yla gÃ¶nderildi!","success")}catch(E){throw console.error("Quote submission error:",E),E}}return J.jsxDEV(e.Fragment,{children:[b.map(P=>J.jsxDEV(ra,{message:P.message,type:P.type,onClose:()=>u(P.id)},P.id,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:55,columnNumber:9},this)),it==="admin"?c?J.jsxDEV(ta,{t,onLogout:k,showNotification:o},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:64,columnNumber:13},this):J.jsxDEV(ia,{onLogin:d,t},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:69,columnNumber:15},this):J.jsxDEV(Rt,{onSubmit:x,showNotification:o,t},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:70,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:53,columnNumber:5},this)}function ia({onLogin:t,t:c}){const[n,b]=ee.useState(""),[o,u]=ee.useState(""),[d,k]=ee.useState(!0),[x,P]=ee.useState(""),[E,y]=ee.useState(!1);async function D(f){if(f.preventDefault(),!n||!o){P("E-posta ve ÅŸifre gerekli");return}y(!0),P("");try{const h=await Y.login(n,o,d);h&&h.token?t():P("GiriÅŸ baÅŸarÄ±sÄ±z. LÃ¼tfen tekrar deneyin.")}catch(h){console.error(h),P(h.message||"GiriÅŸ baÅŸarÄ±sÄ±z. Sunucu hatasÄ±.")}finally{y(!1)}}return J.jsxDEV("div",{className:"gate",children:J.jsxDEV("form",{className:"card",onSubmit:D,style:{maxWidth:400,width:"100%",margin:"0 auto",padding:16,borderRadius:8,boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},children:[J.jsxDEV("h2",{className:"title",style:{marginBottom:16,fontSize:18,textAlign:"center"},children:"Admin GiriÅŸi"},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:106,columnNumber:9},this),x&&J.jsxDEV("div",{className:"notice",style:{marginBottom:12},children:x},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:107,columnNumber:19},this),J.jsxDEV("div",{className:"field",style:{marginBottom:12},children:[J.jsxDEV("label",{style:{marginBottom:4},children:"E-posta"},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:109,columnNumber:11},this),J.jsxDEV("input",{type:"email",name:"email",required:!0,value:n,onChange:f=>b(f.target.value)},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:110,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:108,columnNumber:9},this),J.jsxDEV("div",{className:"field",style:{marginBottom:16},children:[J.jsxDEV("label",{style:{marginBottom:4},children:"Åžifre"},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:113,columnNumber:11},this),J.jsxDEV("input",{type:"password",name:"password",required:!0,value:o,onChange:f=>u(f.target.value)},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:114,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:112,columnNumber:9},this),J.jsxDEV("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center",marginTop:10},children:[J.jsxDEV("label",{style:{display:"flex",alignItems:"center",gap:"8px",color:"white",fontSize:"14px"},children:[J.jsxDEV("input",{type:"checkbox",checked:d,onChange:f=>k(f.target.checked)},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:118,columnNumber:13},this),J.jsxDEV("span",{style:{color:"white"},children:c.remember_me||"Beni hatÄ±rla"},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:119,columnNumber:13},this)]},void 0,!0,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:117,columnNumber:11},this),J.jsxDEV("button",{type:"submit",className:"btn accent",onMouseOver:f=>f.target.style.backgroundColor="rgba(255,255,255,0.2)",onMouseOut:f=>f.target.style.backgroundColor="",style:{transition:"all 0.2s ease"},children:c.login_btn||"GiriÅŸ Yap"},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:121,columnNumber:11},this)]},void 0,!0,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:116,columnNumber:9},this)]},void 0,!0,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:105,columnNumber:7},this)},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:104,columnNumber:5},this)}Ct.createRoot(document.getElementById("root")).render(J.jsxDEV(oa,{},void 0,!1,{fileName:"/Users/umutyalcin/Documents/Burkol/quote-portal/src/main.jsx",lineNumber:130,columnNumber:52},void 0));
